
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Variational State Interface &#8212; netket v3.0 documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/blank.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Quantum Geometric Tensor and Stochastic Reconfiguration" href="sr.html" />
    <link rel="prev" title="The Operator module" href="operator.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/logonav.png" class="logo" alt="logo">
</a>      


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference external nav-link" href="https://www.netket.org/getting_started.html">
  Get Started
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  Documentation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference external nav-link" href="https://www.netket.org/citing">
  Citing
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference external nav-link" href="https://www.netket.org/about.html">
  About
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/netket/netket" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/NetKetOrg" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <p class="caption">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/netket3.html">
   Ground-State Variational Search with NetKet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/jax.html">
   Using JAX as a backend in NetKet - Feature Preview for v3.0
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/G-CNN_Honeycomb.html">
   Using a group convolutional neural network to learn the ground-state of a symmetric spin model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/j1j2.html">
   Variational Monte Carlo with Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/Heisenberg1d.html">
   Learning the ground-state of a spin model with different Neural Networks available in NetKet
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Reference Documentation
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="getting_started.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="changelog.html">
   Change Log
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="superop.html">
   The Lindblad Master Equation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hilbert.html">
   The Hilbert module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="operator.html">
   The Operator module
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   The Variational State Interface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sr.html">
   Quantum Geometric Tensor and Stochastic Reconfiguration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="drivers.html">
   The Drivers API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sharp-bits.html">
   ðŸ”ª The Sharp Bits ðŸ”ª
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Extending NetKet
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="custom_models.html">
   Defining Custom Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="custom_expect.html">
   Overriding defaults in NetKet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="custom_preconditioners.html">
   Defining Custom Preconditioners
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="custom_operator.html">
   Defining Custom Operators
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Developer Documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="contributing.html">
   Contributing to NetKet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="writing-tests.html">
   Writing Tests
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  API documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="api-stability.html">
   API Stability
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="api.html">
   Public API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/graph/netket.graph.AbstractGraph.html">
     netket.graph.AbstractGraph
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/graph/netket.graph.Graph.html">
     netket.graph.Graph
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/graph/netket.graph.Lattice.html">
     netket.graph.Lattice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/graph/netket.graph.Edgeless.html">
     netket.graph.Edgeless
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/graph/netket.graph.Hypercube.html">
     netket.graph.Hypercube
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/graph/netket.graph.lattice.LatticeSite.html">
     netket.graph.lattice.LatticeSite
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/graph/netket.graph.Chain.html">
     netket.graph.Chain
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/graph/netket.graph.Grid.html">
     netket.graph.Grid
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/hilbert/netket.hilbert.AbstractHilbert.html">
     netket.hilbert.AbstractHilbert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/hilbert/netket.hilbert.ContinuousHilbert.html">
     netket.hilbert.ContinuousHilbert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/hilbert/netket.hilbert.DiscreteHilbert.html">
     netket.hilbert.DiscreteHilbert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/hilbert/netket.hilbert.HomogeneousHilbert.html">
     netket.hilbert.HomogeneousHilbert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/hilbert/netket.hilbert.CustomHilbert.html">
     netket.hilbert.CustomHilbert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/hilbert/netket.hilbert.TensorHilbert.html">
     netket.hilbert.TensorHilbert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/hilbert/netket.hilbert.DoubledHilbert.html">
     netket.hilbert.DoubledHilbert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/hilbert/netket.hilbert.Spin.html">
     netket.hilbert.Spin
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/hilbert/netket.hilbert.Qubit.html">
     netket.hilbert.Qubit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/hilbert/netket.hilbert.Fock.html">
     netket.hilbert.Fock
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/hilbert/netket.hilbert.Particle.html">
     netket.hilbert.Particle
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.AbstractOperator.html">
     netket.operator.AbstractOperator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.DiscreteOperator.html">
     netket.operator.DiscreteOperator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.BoseHubbard.html">
     netket.operator.BoseHubbard
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.GraphOperator.html">
     netket.operator.GraphOperator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.LocalOperator.html">
     netket.operator.LocalOperator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.Ising.html">
     netket.operator.Ising
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.Heisenberg.html">
     netket.operator.Heisenberg
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.PauliStrings.html">
     netket.operator.PauliStrings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.LocalLiouvillian.html">
     netket.operator.LocalLiouvillian
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.boson.create.html">
     netket.operator.boson.create
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.boson.destroy.html">
     netket.operator.boson.destroy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.boson.number.html">
     netket.operator.boson.number
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.boson.proj.html">
     netket.operator.boson.proj
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.spin.sigmax.html">
     netket.operator.spin.sigmax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.spin.sigmay.html">
     netket.operator.spin.sigmay
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.spin.sigmaz.html">
     netket.operator.spin.sigmaz
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.spin.sigmap.html">
     netket.operator.spin.sigmap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.spin.sigmam.html">
     netket.operator.spin.sigmam
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.ContinuousOperator.html">
     netket.operator.ContinuousOperator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.KineticEnergy.html">
     netket.operator.KineticEnergy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.PotentialEnergy.html">
     netket.operator.PotentialEnergy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/operator/netket.operator.SumOperator.html">
     netket.operator.SumOperator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/exact/netket.exact.full_ed.html">
     netket.exact.full_ed
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/exact/netket.exact.lanczos_ed.html">
     netket.exact.lanczos_ed
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/exact/netket.exact.steady_state.html">
     netket.exact.steady_state
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.sampler_state.html">
     netket.sampler.sampler_state
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.reset.html">
     netket.sampler.reset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.sample_next.html">
     netket.sampler.sample_next
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.sample.html">
     netket.sampler.sample
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.samples.html">
     netket.sampler.samples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.Sampler.html">
     netket.sampler.Sampler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.ExactSampler.html">
     netket.sampler.ExactSampler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.MetropolisSampler.html">
     netket.sampler.MetropolisSampler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.MetropolisSamplerNumpy.html">
     netket.sampler.MetropolisSamplerNumpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.experimental.sampler.MetropolisPtSampler.html">
     netket.experimental.sampler.MetropolisPtSampler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.MetropolisLocal.html">
     netket.sampler.MetropolisLocal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.MetropolisExchange.html">
     netket.sampler.MetropolisExchange
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.MetropolisHamiltonian.html">
     netket.sampler.MetropolisHamiltonian
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.experimental.sampler.MetropolisLocalPt.html">
     netket.experimental.sampler.MetropolisLocalPt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.experimental.sampler.MetropolisExchangePt.html">
     netket.experimental.sampler.MetropolisExchangePt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.ARDirectSampler.html">
     netket.sampler.ARDirectSampler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.MetropolisRule.html">
     netket.sampler.MetropolisRule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.rules.LocalRule.html">
     netket.sampler.rules.LocalRule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.rules.ExchangeRule.html">
     netket.sampler.rules.ExchangeRule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.rules.HamiltonianRule.html">
     netket.sampler.rules.HamiltonianRule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.rules.HamiltonianRuleNumpy.html">
     netket.sampler.rules.HamiltonianRuleNumpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.rules.CustomRuleNumpy.html">
     netket.sampler.rules.CustomRuleNumpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.SamplerState.html">
     netket.sampler.SamplerState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/samplers/netket.sampler.MetropolisSamplerState.html">
     netket.sampler.MetropolisSamplerState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/models/netket.models.RBM.html">
     netket.models.RBM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/models/netket.models.RBMModPhase.html">
     netket.models.RBMModPhase
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/models/netket.models.RBMMultiVal.html">
     netket.models.RBMMultiVal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/models/netket.models.RBMSymm.html">
     netket.models.RBMSymm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/models/netket.models.Jastrow.html">
     netket.models.Jastrow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/models/netket.models.MPSPeriodic.html">
     netket.models.MPSPeriodic
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/models/netket.models.NDM.html">
     netket.models.NDM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/models/netket.models.GCNN.html">
     netket.models.GCNN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/models/netket.models.AbstractARNN.html">
     netket.models.AbstractARNN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/models/netket.models.ARNNDense.html">
     netket.models.ARNNDense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/models/netket.models.ARNNConv1D.html">
     netket.models.ARNNConv1D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/models/netket.models.ARNNConv2D.html">
     netket.models.ARNNConv2D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/models/netket.models.FastARNNConv1D.html">
     netket.models.FastARNNConv1D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/models/netket.models.FastARNNConv2D.html">
     netket.models.FastARNNConv2D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.Module.html">
     netket.nn.Module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.Dense.html">
     netket.nn.Dense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.DenseGeneral.html">
     netket.nn.DenseGeneral
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.DenseSymm.html">
     netket.nn.DenseSymm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.DenseEquivariant.html">
     netket.nn.DenseEquivariant
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.Conv.html">
     netket.nn.Conv
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.Embed.html">
     netket.nn.Embed
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.MaskedDense1D.html">
     netket.nn.MaskedDense1D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.MaskedConv1D.html">
     netket.nn.MaskedConv1D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.MaskedConv2D.html">
     netket.nn.MaskedConv2D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.celu.html">
     netket.nn.celu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.elu.html">
     netket.nn.elu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.gelu.html">
     netket.nn.gelu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.glu.html">
     netket.nn.glu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.log_sigmoid.html">
     netket.nn.log_sigmoid
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.log_softmax.html">
     netket.nn.log_softmax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.relu.html">
     netket.nn.relu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.sigmoid.html">
     netket.nn.sigmoid
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.soft_sign.html">
     netket.nn.soft_sign
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.softmax.html">
     netket.nn.softmax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.softplus.html">
     netket.nn.softplus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.swish.html">
     netket.nn.swish
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.log_cosh.html">
     netket.nn.log_cosh
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.reim_relu.html">
     netket.nn.reim_relu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/nn/netket.nn.reim_selu.html">
     netket.nn.reim_selu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/variational/netket.vqs.VariationalState.html">
     netket.vqs.VariationalState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/variational/netket.vqs.ExactState.html">
     netket.vqs.ExactState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/variational/netket.vqs.MCState.html">
     netket.vqs.MCState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/variational/netket.vqs.MCMixedState.html">
     netket.vqs.MCMixedState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/variational/netket.vqs.get_local_kernel.html">
     netket.vqs.get_local_kernel
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/variational/netket.vqs.get_local_kernel_arguments.html">
     netket.vqs.get_local_kernel_arguments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/optim/netket.optimizer.Adam.html">
     netket.optimizer.Adam
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/optim/netket.optimizer.AdaGrad.html">
     netket.optimizer.AdaGrad
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/optim/netket.optimizer.Sgd.html">
     netket.optimizer.Sgd
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/optim/netket.optimizer.Momentum.html">
     netket.optimizer.Momentum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/optim/netket.optimizer.RmsProp.html">
     netket.optimizer.RmsProp
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/optim/netket.optimizer.SR.html">
     netket.optimizer.SR
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/optim/netket.optimizer.qgt.QGTAuto.html">
     netket.optimizer.qgt.QGTAuto
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/optim/netket.optimizer.qgt.QGTOnTheFly.html">
     netket.optimizer.qgt.QGTOnTheFly
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/optim/netket.optimizer.qgt.QGTJacobianPyTree.html">
     netket.optimizer.qgt.QGTJacobianPyTree
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/optim/netket.optimizer.qgt.QGTJacobianDense.html">
     netket.optimizer.qgt.QGTJacobianDense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/optim/netket.optimizer.solver.svd.html">
     netket.optimizer.solver.svd
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/optim/netket.optimizer.solver.cholesky.html">
     netket.optimizer.solver.cholesky
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/optim/netket.optimizer.solver.LU.html">
     netket.optimizer.solver.LU
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/optim/netket.optimizer.solver.solve.html">
     netket.optimizer.solver.solve
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/driver/netket.driver.AbstractVariationalDriver.html">
     netket.driver.AbstractVariationalDriver
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/driver/netket.driver.VMC.html">
     netket.driver.VMC
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/driver/netket.driver.SteadyState.html">
     netket.driver.SteadyState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/driver/netket.logging.RuntimeLog.html">
     netket.logging.RuntimeLog
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/driver/netket.logging.JsonLog.html">
     netket.logging.JsonLog
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/driver/netket.logging.StateLog.html">
     netket.logging.StateLog
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/driver/netket.logging.TensorBoardLog.html">
     netket.logging.TensorBoardLog
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/utils/netket.utils.HashableArray.html">
     netket.utils.HashableArray
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/callbacks/netket.callbacks.EarlyStopping.html">
     netket.callbacks.EarlyStopping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/callbacks/netket.callbacks.Timeout.html">
     netket.callbacks.Timeout
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="api-experimental.html">
   Experimental API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/samplers/netket.experimental.sampler.MetropolisPtSampler.html">
     netket.experimental.sampler.MetropolisPtSampler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/samplers/netket.experimental.sampler.MetropolisLocalPt.html">
     netket.experimental.sampler.MetropolisLocalPt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/samplers/netket.experimental.sampler.MetropolisExchangePt.html">
     netket.experimental.sampler.MetropolisExchangePt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/samplers/netket.experimental.sampler.MetropolisSamplerPmap.html">
     netket.experimental.sampler.MetropolisSamplerPmap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/variational/netket.experimental.vqs.variables_from_file.html">
     netket.experimental.vqs.variables_from_file
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/variational/netket.experimental.vqs.variables_from_tar.html">
     netket.experimental.vqs.variables_from_tar
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/dynamics/netket.experimental.driver.TDVP.html">
     netket.experimental.driver.TDVP
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#constructing-a-variational-state">
   Constructing a Variational State
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#defining-models-flax">
     Defining models: Flax
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mcstate">
     MCState
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-a-monte-carlo-variational-state">
   Using a Monte Carlo Variational State
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#expectation-values">
     Expectation values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sampling">
     Sampling
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#collecting-the-state-vector">
     Collecting the state-vector
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#manipulating-the-parameters">
     Manipulating the parameters
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#saving-and-loading-a-variational-state">
   Saving and Loading a Variational State
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-exactstate-for-testing">
   Using ExactState for testing
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="the-variational-state-interface">
<h1>The Variational State Interface<a class="headerlink" href="#the-variational-state-interface" title="Permalink to this headline">Â¶</a></h1>
<p>A central element of NetKet is the <a class="reference internal" href="_generated/variational/netket.vqs.VariationalState.html#netket.vqs.VariationalState" title="netket.vqs.VariationalState"><code class="xref py py-class docutils literal notranslate"><span class="pre">VariationalState</span></code></a> interface.
A Variational State represents an approximate, variational description of a system, and can be used to
probe it.</p>
<p>As of now, NetKet has two types of Variational state implementations:</p>
<ul class="simple">
<li><p><a class="reference internal" href="_generated/variational/netket.vqs.MCState.html#netket.vqs.MCState" title="netket.vqs.MCState"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCState</span></code></a>, which is a classical variational approximation of a pure state.</p></li>
<li><p><a class="reference internal" href="_generated/variational/netket.vqs.MCMixedState.html#netket.vqs.MCMixedState" title="netket.vqs.MCMixedState"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCMixedState</span></code></a>, which is a classical variational approximation of a mixed state.</p></li>
</ul>
<p>It is our plan to build upon this interface for new kind of variational states in the future. For example, we
are interested in implementing a new kind of variational state that encodes a state into a Qiskit circuit.</p>
<div class="section" id="constructing-a-variational-state">
<h2>Constructing a Variational State<a class="headerlink" href="#constructing-a-variational-state" title="Permalink to this headline">Â¶</a></h2>
<p>To construct the two variational states above you need to provide at least a Monte Carlo sampler (you can see
the list of available ones <a class="reference internal" href="api.html#sampler-api"><span class="std std-ref">here</span></a>) and a model.
The hilbert space of the variational state will be inferred from the sampler, as they all reference the
hilbert space they are sampling.</p>
<p>The model can be specified in several ways. The most standard way is to pass a <a class="reference external" href="https://flax.readthedocs.io/en/latest/flax.linen.html#module">Flax Linen Module</a>, but you can also pass a Jax-style pair
of functions <code class="code docutils literal notranslate"><span class="pre">(init,</span> <span class="pre">apply)</span></code> or an haiku module obtained by calling <code class="code docutils literal notranslate"><span class="pre">haiku.transform()</span></code>.
Itâ€™s also easy to use another jax-based framework with NetKet (though itâ€™s not yet documented). If you
want to do that, you can have a look at the automatic conversion <a class="reference external" href="https://github.com/netket/netket/tree/master/netket/utils/model_frameworks">code</a> and get in touch with us.</p>
<p>:::{warning}
Initializing a Variational State with non-Flax modules is still experimental. Complex modules,
especially if mutable, might not work. If you have problems donâ€™t hesitate opening issues on
GitHub so that we can address them. They are mostly easy fixes.
:::</p>
<div class="section" id="defining-models-flax">
<h3>Defining models: Flax<a class="headerlink" href="#defining-models-flax" title="Permalink to this headline">Â¶</a></h3>
<p>In general, the most-well supported way to define Models for NetKet is through Flax.</p>
<p>If you are not familiar with Flax, itâ€™s a package that allows to define Neural Networks or other
parametrized functions. While we suggest to read carefully the <a class="reference external" href="https://flax.readthedocs.io/en/latest/notebooks/flax_basics.html">introduction to Flax</a>, if you are impatient and just want to define some simple, easy
models you can find some examples in the <a class="reference external" href="https://flax.readthedocs.io/en/latest/howtos/model_surgery.html">Model Surgery</a> section of Flax documentation.</p>
<p>Other examples can be found in the source of the <span class="xref std std-ref">Pre-built models</span> distributed with NetKet, such as
<a class="reference internal" href="_generated/models/netket.models.RBM.html#netket.models.RBM" title="netket.models.RBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">RBM</span></code></a> (the simplest one), <a class="reference internal" href="_generated/models/netket.models.MPSPeriodic.html#netket.models.MPSPeriodic" title="netket.models.MPSPeriodic"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPSPeriodic</span></code></a> and <a class="reference internal" href="_generated/models/netket.models.NDM.html#netket.models.NDM" title="netket.models.NDM"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDM</span></code></a> for
more complicated examples.</p>
<p>:::{warning}
Flax modules do not always work well with complex numbers. For that reason, if your model has complex
parameters we invite you to use <code class="code docutils literal notranslate"><span class="pre">netket.nn</span></code> in place of <code class="code docutils literal notranslate"><span class="pre">flax.linen</span></code> and <code class="code docutils literal notranslate"><span class="pre">flax.nn</span></code>.</p>
<p><code class="code docutils literal notranslate"><span class="pre">netket.nn</span></code> re-exports some Flax functionality ensuring that it works nicely with complex numbers.
If you donâ€™t find something from Flax in <code class="code docutils literal notranslate"><span class="pre">netket.nn</span></code>, please <a class="reference external" href="https://github.com/netket/netket/issues">open an issue</a> in GitHub.
:::</p>
</div>
<div class="section" id="mcstate">
<h3>MCState<a class="headerlink" href="#mcstate" title="Permalink to this headline">Â¶</a></h3>
<p>Letâ€™s now assume we have a Flax module, <a class="reference internal" href="_generated/models/netket.models.RBM.html#netket.models.RBM" title="netket.models.RBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">RBM</span></code></a> and we want to construct a variational state
on sampled with a simple <a class="reference internal" href="_generated/samplers/netket.sampler.MetropolisLocal.html#netket.sampler.MetropolisLocal" title="netket.sampler.MetropolisLocal"><code class="xref py py-func docutils literal notranslate"><span class="pre">MetropolisLocal()</span></code></a> sampler.</p>
<p>To do this, first you need to construct the model and the sampler, and then you can pass them, together with several
parameters, to the constructor.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hilbert</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">hilbert</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">**</span><span class="mi">10</span>

<span class="n">sampler</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">MetropolisLocal</span><span class="p">(</span><span class="n">hilbert</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">RBM</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">kernel_init</span><span class="o">=</span><span class="n">nk</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">stddev</span><span class="o">=</span><span class="mf">0.01</span><span class="p">))</span>

<span class="n">vstate</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">vqs</span><span class="o">.</span><span class="n">MCState</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
<p>When constructed, the variational state will call the modelâ€™s init method to generate the state and the
parameters, and will also initialize the sampler.</p>
<p>When constructing a variational state you can also pass a seed, that will be used to initialize both the
weights and the sampler. You can also pass two different seeds for the sampler and the weights.</p>
<p id="warn-chunking">:::{warning}
Sometimes you might be working on very large models that run on GPUs, or you might want to compute expectaion values with a very high number of samples, which might cause out-of-memory errors. To prevent this, <code class="code docutils literal notranslate"><span class="pre">MCState</span></code> exposes the attribute <a class="reference internal" href="_generated/variational/netket.vqs.MCState.html#netket.vqs.MCState.chunk_size" title="netket.vqs.MCState.chunk_size"><code class="xref py py-attr docutils literal notranslate"><span class="pre">chunk_size</span></code></a>, which controls the size of the chunks used in the forward and backward computation of expectation values.</p>
<p>When this value is set, computations are not performed on huge matrices, but instead we split the inputs into smaller matrices and loop through them. In general, setting <a class="reference internal" href="_generated/variational/netket.vqs.MCState.html#netket.vqs.MCState.chunk_size" title="netket.vqs.MCState.chunk_size"><code class="xref py py-attr docutils literal notranslate"><span class="pre">chunk_size</span></code></a> to a low value will address the majority of memory issues, but will increase the computational cost.</p>
<p>A value of at least 128 is suggested, but will geatly depend on your model. You should try to use the largest value you can for your system. Setting it to <code class="code docutils literal notranslate"><span class="pre">None</span></code> is equivalent to setting it to infinity.
:::</p>
</div>
</div>
<div class="section" id="using-a-monte-carlo-variational-state">
<h2>Using a Monte Carlo Variational State<a class="headerlink" href="#using-a-monte-carlo-variational-state" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="expectation-values">
<h3>Expectation values<a class="headerlink" href="#expectation-values" title="Permalink to this headline">Â¶</a></h3>
<p>One you have a variational state, you can do many things with it.
First of all, you can probe expectation values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>HÌ‚ = nk.operator.Ising(hilbert, nk.graph.Chain(hilbert.size), h=0.5)

vstate.expect(HÌ‚)

&gt;&gt;&gt; -4.98 Â± 0.14 [ÏƒÂ²=9.51, RÌ‚=1.0006]
</pre></div>
</div>
<p>Notice that if you call multiple times <code class="code docutils literal notranslate"><span class="pre">expect</span></code>, the same set of
samples will be used, and you will get the same result. To force sampling
to happen again, you can call <a class="reference internal" href="_generated/variational/netket.vqs.MCState.html#netket.vqs.MCState.sample" title="netket.vqs.MCState.sample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample()</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>vstate.expect(HÌ‚)

&gt;&gt;&gt; -4.98 Â± 0.14 [ÏƒÂ²=9.51, RÌ‚=1.0006]

vstate.sample();

vstate.expect(HÌ‚)

&gt;&gt;&gt; -4.90 Â± 0.14 [ÏƒÂ²=9.54, RÌ‚=1.0062]
</pre></div>
</div>
<p>The set of the last sampled samples can be accessed from the attribute
<a class="reference internal" href="_generated/variational/netket.vqs.MCState.html#netket.vqs.MCState.samples" title="netket.vqs.MCState.samples"><code class="xref py py-attr docutils literal notranslate"><span class="pre">samples</span></code></a>. If you access the samples
from this attribute, but you havenâ€™t sampled already, <code class="code docutils literal notranslate"><span class="pre">sample()</span></code> will
be called automatically.</p>
<p>Note that when you update the parameters, the samples are automatically
discarded.</p>
<p>Parameters can be accessed through the attribute <a class="reference internal" href="_generated/variational/netket.vqs.VariationalState.html#netket.vqs.VariationalState.parameters" title="netket.vqs.VariationalState.parameters"><code class="xref py py-attr docutils literal notranslate"><span class="pre">parameters</span></code></a>,
and you can modify them by assigning a new set of parameters to this attribute.</p>
<p>Note that parameters cannot in general be modified in place, as they are
of type <code class="docutils literal notranslate"><span class="pre">FrozenDict</span></code> (they are frozen, aka canâ€™t be modified). A typical way
to modify them, for example to add 0.1 to all parameters is to do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jax</span>

<span class="c1"># See the value of some parameters</span>
<span class="n">vstate</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;visible_bias&#39;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">DeviceArray</span><span class="p">([</span><span class="o">-</span><span class="mf">0.10806808</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.14987472</span><span class="p">,</span>  <span class="mf">0.13069461</span><span class="p">,</span>  <span class="mf">0.0125838</span> <span class="p">,</span>
              <span class="mf">0.06278384</span><span class="p">,</span>  <span class="mf">0.00275547</span><span class="p">,</span>  <span class="mf">0.05843748</span><span class="p">,</span>  <span class="mf">0.07516951</span><span class="p">,</span>
              <span class="mf">0.21897993</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01632223</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)</span>

<span class="n">vstate</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">vstate</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>

<span class="c1"># Look at the new values</span>
<span class="n">vstate</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;visible_bias&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">DeviceArray</span><span class="p">([</span><span class="o">-</span><span class="mf">0.00806808</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04987472</span><span class="p">,</span>  <span class="mf">0.23069461</span><span class="p">,</span>  <span class="mf">0.1125838</span> <span class="p">,</span>
              <span class="mf">0.16278384</span><span class="p">,</span>  <span class="mf">0.10275547</span><span class="p">,</span>  <span class="mf">0.15843748</span><span class="p">,</span>  <span class="mf">0.17516951</span><span class="p">,</span>
              <span class="mf">0.31897993</span><span class="p">,</span>  <span class="mf">0.08367777</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="sampling">
<h3>Sampling<a class="headerlink" href="#sampling" title="Permalink to this headline">Â¶</a></h3>
<p>You can also change the number of samples to extract (note: this will
trigger recompilation of the sample function, so you should not do this
in a hot loop) by changing <a class="reference internal" href="_generated/variational/netket.vqs.MCState.html#netket.vqs.MCState.n_samples" title="netket.vqs.MCState.n_samples"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_samples</span></code></a>, and
the number of discarded samples at the beginning of every markov chain by
changing <a class="reference internal" href="_generated/variational/netket.vqs.MCState.html#netket.vqs.MCState.n_discard_per_chain" title="netket.vqs.MCState.n_discard_per_chain"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_discard_per_chain</span></code></a>.</p>
<p>By default, <a class="reference internal" href="_generated/variational/netket.vqs.MCState.html#netket.vqs.MCState.n_discard_per_chain" title="netket.vqs.MCState.n_discard_per_chain"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_discard_per_chain</span></code></a> is 10% of
<a class="reference internal" href="_generated/variational/netket.vqs.MCState.html#netket.vqs.MCState.n_samples" title="netket.vqs.MCState.n_samples"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_samples</span></code></a>.</p>
<p>The number of samples is then split among the number of chains/batches of the sampler.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hilbert</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">hilbert</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">**</span><span class="mi">6</span>

<span class="n">sampler</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">MetropolisLocal</span><span class="p">(</span><span class="n">hilbert</span><span class="p">,</span> <span class="n">n_chains</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">vstate</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">vqs</span><span class="o">.</span><span class="n">MCState</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">nk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">RBM</span><span class="p">(),</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">vstate</span><span class="o">.</span><span class="n">n_samples</span><span class="p">)</span>
<span class="mi">504</span>

<span class="nb">print</span><span class="p">(</span><span class="n">vstate</span><span class="o">.</span><span class="n">chain_length</span><span class="p">)</span>
<span class="mi">63</span>

<span class="nb">print</span><span class="p">(</span><span class="n">vstate</span><span class="o">.</span><span class="n">n_discard_per_chain</span><span class="p">)</span>
<span class="mi">50</span>
</pre></div>
</div>
<p>You can see that 500 samples are split among 8 chains, giving <span class="math notranslate nohighlight">\(500/8=62.5\)</span> (rounded to
the next largest integer, 63). Therefore 8 chains of length 63 will be run.
n_discard_per_chain gives the number of discarded steps taken in the markov chain before actually storing
them, so the Markov Chains are actually <code class="code docutils literal notranslate"><span class="pre">chain_length</span> <span class="pre">+</span> <span class="pre">n_discard_per_chain</span></code> long. The default
n_discard_per_chain is 10% of the total samples, but you can change that to any number.</p>
<p id="warn-mpi-sampling">:::{warning}
When running your code under MPI, the length of the chain is computed not only by dividing the
total number of samples by <code class="code docutils literal notranslate"><span class="pre">n_chains</span></code>, but also by diving it by the number of MPI processes.</p>
<p>Therefore, considering the number from the example above, if we had 4 MPI processes, we would have
found a chain length of <span class="math notranslate nohighlight">\(500/(8*4) = 15.625 \rightarrow 16\)</span>.
:::</p>
</div>
<div class="section" id="collecting-the-state-vector">
<h3>Collecting the state-vector<a class="headerlink" href="#collecting-the-state-vector" title="Permalink to this headline">Â¶</a></h3>
<p>A variational state can be evaluated on the whole Hilbert space in order to obtain
the ket it represents.</p>
<p>This is achieved by using the <a class="reference internal" href="_generated/variational/netket.vqs.VariationalState.html#netket.vqs.VariationalState.to_array" title="netket.vqs.VariationalState.to_array"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_array()</span></code></a> method,
which by defaults normalises the <span class="math notranslate nohighlight">\(L_2\)</span> norm of the vector to 1 (but can be turned off).</p>
<p>Mixed state ansatzes can be converted to their matrix representation with
<a class="reference internal" href="_generated/variational/netket.vqs.MCMixedState.html#netket.vqs.MCMixedState.to_matrix" title="netket.vqs.MCMixedState.to_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_matrix()</span></code></a>. In this case, the default
normalisation sets the trace to 1.</p>
</div>
<div class="section" id="manipulating-the-parameters">
<h3>Manipulating the parameters<a class="headerlink" href="#manipulating-the-parameters" title="Permalink to this headline">Â¶</a></h3>
<p>You can access the parameters of a variational state through the <a class="reference internal" href="_generated/variational/netket.vqs.VariationalState.html#netket.vqs.VariationalState.parameters" title="netket.vqs.VariationalState.parameters"><code class="xref py py-attr docutils literal notranslate"><span class="pre">parameters</span></code></a> attribute.
Similarly, if your model has also a mutable state, you can access it through
the <a class="reference internal" href="_generated/variational/netket.vqs.VariationalState.html#netket.vqs.VariationalState.model_state" title="netket.vqs.VariationalState.model_state"><code class="xref py py-attr docutils literal notranslate"><span class="pre">model_state</span></code></a> attribute.</p>
<p>Parameters are stored as a Flax <code class="code docutils literal notranslate"><span class="pre">FrozenDict</span></code>, which behaves like a standard python dictionary but cannot be modified.
In Jax jargon, Parameters are a PyTree (see <a class="reference external" href="https://jax.readthedocs.io/en/latest/pytrees.html">PyTree documentation</a>) and they
can be operated upon with functions like <a class="reference external" href="https://jax.readthedocs.io/en/latest/jax.tree_util.html?highlight=tree_map#jax.tree_util.tree_map">jax.tree_map</a>.</p>
<p>You can also modify the parameters by _unfreezing_ them, using the command <code class="docutils literal notranslate"><span class="pre">flax.core.unfreeze</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">flax</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">flax</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">(</span><span class="n">varstate</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>

<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;Dense&#39;</span><span class="p">][</span><span class="s1">&#39;kernel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;Dense&#39;</span><span class="p">][</span><span class="s1">&#39;kernel&#39;</span><span class="p">]</span> <span class="o">+</span><span class="mi">1</span>

<span class="n">varstate</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">pars</span>
</pre></div>
</div>
<p>The parameter dict will be automatically frozen upon assignment.</p>
</div>
</div>
<div class="section" id="saving-and-loading-a-variational-state">
<h2>Saving and Loading a Variational State<a class="headerlink" href="#saving-and-loading-a-variational-state" title="Permalink to this headline">Â¶</a></h2>
<p>Variational States conform to the <a class="reference external" href="https://flax.readthedocs.io/en/latest/flax.serialization.html">Flax serialization interface</a> and can be serialized and deserialized with it.</p>
<p>Moreover, the Json Logger <a class="reference internal" href="_generated/driver/netket.logging.JsonLog.html#netket.logging.JsonLog" title="netket.logging.JsonLog"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsonLog</span></code></a> serializes the variational state
through that interface.</p>
<p>A simple example to serialize data is provided below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># construct an RBM model on 10 spins</span>
<span class="n">vstate</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">vqs</span><span class="o">.</span><span class="n">MCState</span><span class="p">(</span><span class="n">nk</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">MetropolisLocal</span><span class="p">(</span><span class="n">nk</span><span class="o">.</span><span class="n">hilbert</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">**</span><span class="mi">10</span><span class="p">),</span>
                                <span class="n">nk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">RBM</span><span class="p">())</span>

<span class="kn">import</span> <span class="nn">flax</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;test.mpack&quot;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
  <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">flax</span><span class="o">.</span><span class="n">serialization</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">vstate</span><span class="p">))</span>
</pre></div>
</div>
<p>And here we de-serialize it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># construct a new RBM model on 10 spins</span>
<span class="n">vstate</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">vqs</span><span class="o">.</span><span class="n">MCState</span><span class="p">(</span><span class="n">nk</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">MetropolisLocal</span><span class="p">(</span><span class="n">nk</span><span class="o">.</span><span class="n">hilbert</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">**</span><span class="mi">10</span><span class="p">),</span>
                                <span class="n">nk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">RBM</span><span class="p">())</span>

<span class="c1"># load</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;test.mpack&quot;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
  <span class="n">vstate</span> <span class="o">=</span> <span class="n">flax</span><span class="o">.</span><span class="n">serialization</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">vstate</span><span class="p">,</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
<p>Note that this also serializes the state of the sampler.</p>
<p>:::{note}
The JSonLog serializer only serializes the parameters of the model, and not the whole variational state.
Therefore, if you wish to reload the parameters of a variational state, saved by the json logger, you should
use the same procedure outlined above, only that the list line should be:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;parameters.mpack&quot;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
  <span class="n">vstate</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="n">flax</span><span class="o">.</span><span class="n">serialization</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">vstate</span><span class="o">.</span><span class="n">variables</span><span class="p">,</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
<p>:::</p>
</div>
<div class="section" id="using-exactstate-for-testing">
<h2>Using ExactState for testing<a class="headerlink" href="#using-exactstate-for-testing" title="Permalink to this headline">Â¶</a></h2>
<p>In order to check the performance of a given model on small test systems, it is possible to use <code class="xref py py-class docutils literal notranslate"><span class="pre">ExactState</span></code> which can be used in place of <a class="reference internal" href="_generated/variational/netket.vqs.MCState.html#netket.vqs.MCState" title="netket.vqs.MCState"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCState</span></code></a> and computes quantities not by stochastic sampling but by evaluation of the ansatz over the full Hilbert space basis. (Therefore, it is infeasible to use for system sizes beyond ED.)
This can be helpful to diagnose potential errors arising from Monte Carlo sampling.
.. code:: python</p>
<blockquote>
<div><p>vs = nk.vqs.ExactState(hilbert, nk.models.RBM())</p>
</div></blockquote>
</div>
</div>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="operator.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">The Operator module</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="sr.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Quantum Geometric Tensor and Stochastic Reconfiguration</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2019-2021, The Netket authors - All rights reserved.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br>
</p>
    </div>
    
  </div>
</footer>

<script type="text/javascript">
    jQuery(function () {
        SphinxRtdTheme.Navigation.enable(true);
      })
</script>

<!-- Temporary footer
<div class="footer-wip">
  <div class="footer-wip-content">
    This documentation refers to an unreleased version of Netket.
  </div>
</div>
-->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-118013987-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-118013987-1');
</script>

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "url": "https://www.netket.org",
  "name": "NetKet",
  "founder": "Giuseppe Carleo",
  "foundingDate": "2018-04-24",
  "foundingLocation" : "New York",
  "logo": "https://www.netket.org/img/logo_small.jpg",
  "sameAs": [
    "https://twitter.com/NetKetOrg",
    "https://github.com/NetKet/netket"
  ],
  "description" : "Netket is an open-source project delivering cutting-edge
  methods for the study of many-body quantum systems with artificial neural
  networks and machine learning techniques."
}
</script>

  </body>
</html>