
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Using JAX as a backend in NetKet - Feature Preview for v3.0 &#8212; netket v3.0 documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/blank.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using a group convolutional neural network to learn the ground-state of a symmetric spin model" href="G-CNN_Honeycomb.html" />
    <link rel="prev" title="Ground-State Variational Search with NetKet" href="netket3.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/logonav.png" class="logo" alt="logo">
</a>      


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference external nav-link" href="https://www.netket.org/getting_started.html">
  Get Started
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../docs/index.html">
  Documentation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference external nav-link" href="https://www.netket.org/citing">
  Citing
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference external nav-link" href="https://www.netket.org/about.html">
  About
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/netket/netket" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/NetKetOrg" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <p class="caption">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="netket3.html">
   Ground-State Variational Search with NetKet
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Using JAX as a backend in NetKet - Feature Preview for v3.0
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="G-CNN_Honeycomb.html">
   Using a group convolutional neural network to learn the ground-state of a symmetric spin model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="j1j2.html">
   Variational Monte Carlo with Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Heisenberg1d.html">
   Learning the ground-state of a spin model with different Neural Networks available in NetKet
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Reference Documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/getting_started.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/changelog.html">
   Change Log
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/superop.html">
   The Lindblad Master Equation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/hilbert.html">
   The Hilbert module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/operator.html">
   The Operator module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/varstate.html">
   The Variational State Interface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/sr.html">
   Quantum Geometric Tensor and Stochastic Reconfiguration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/drivers.html">
   The Drivers API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/sharp-bits.html">
   ðŸ”ª The Sharp Bits ðŸ”ª
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Extending NetKet
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/custom_models.html">
   Defining Custom Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/custom_expect.html">
   Overriding defaults in NetKet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/custom_preconditioners.html">
   Defining Custom Preconditioners
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/custom_operator.html">
   Defining Custom Operators
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Developer Documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/contributing.html">
   Contributing to NetKet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/writing-tests.html">
   Writing Tests
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  API documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/api-stability.html">
   API Stability
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../docs/api.html">
   Public API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/graph/netket.graph.AbstractGraph.html">
     netket.graph.AbstractGraph
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/graph/netket.graph.Graph.html">
     netket.graph.Graph
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/graph/netket.graph.Lattice.html">
     netket.graph.Lattice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/graph/netket.graph.Edgeless.html">
     netket.graph.Edgeless
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/graph/netket.graph.Hypercube.html">
     netket.graph.Hypercube
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/graph/netket.graph.lattice.LatticeSite.html">
     netket.graph.lattice.LatticeSite
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/graph/netket.graph.Chain.html">
     netket.graph.Chain
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/graph/netket.graph.Grid.html">
     netket.graph.Grid
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/hilbert/netket.hilbert.AbstractHilbert.html">
     netket.hilbert.AbstractHilbert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/hilbert/netket.hilbert.ContinuousHilbert.html">
     netket.hilbert.ContinuousHilbert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/hilbert/netket.hilbert.DiscreteHilbert.html">
     netket.hilbert.DiscreteHilbert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/hilbert/netket.hilbert.HomogeneousHilbert.html">
     netket.hilbert.HomogeneousHilbert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/hilbert/netket.hilbert.CustomHilbert.html">
     netket.hilbert.CustomHilbert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/hilbert/netket.hilbert.TensorHilbert.html">
     netket.hilbert.TensorHilbert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/hilbert/netket.hilbert.DoubledHilbert.html">
     netket.hilbert.DoubledHilbert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/hilbert/netket.hilbert.Spin.html">
     netket.hilbert.Spin
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/hilbert/netket.hilbert.Qubit.html">
     netket.hilbert.Qubit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/hilbert/netket.hilbert.Fock.html">
     netket.hilbert.Fock
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/hilbert/netket.hilbert.Particle.html">
     netket.hilbert.Particle
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.AbstractOperator.html">
     netket.operator.AbstractOperator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.DiscreteOperator.html">
     netket.operator.DiscreteOperator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.BoseHubbard.html">
     netket.operator.BoseHubbard
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.GraphOperator.html">
     netket.operator.GraphOperator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.LocalOperator.html">
     netket.operator.LocalOperator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.Ising.html">
     netket.operator.Ising
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.Heisenberg.html">
     netket.operator.Heisenberg
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.PauliStrings.html">
     netket.operator.PauliStrings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.LocalLiouvillian.html">
     netket.operator.LocalLiouvillian
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.boson.create.html">
     netket.operator.boson.create
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.boson.destroy.html">
     netket.operator.boson.destroy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.boson.number.html">
     netket.operator.boson.number
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.boson.proj.html">
     netket.operator.boson.proj
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.spin.sigmax.html">
     netket.operator.spin.sigmax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.spin.sigmay.html">
     netket.operator.spin.sigmay
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.spin.sigmaz.html">
     netket.operator.spin.sigmaz
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.spin.sigmap.html">
     netket.operator.spin.sigmap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.spin.sigmam.html">
     netket.operator.spin.sigmam
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.ContinuousOperator.html">
     netket.operator.ContinuousOperator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.KineticEnergy.html">
     netket.operator.KineticEnergy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.PotentialEnergy.html">
     netket.operator.PotentialEnergy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/operator/netket.operator.SumOperator.html">
     netket.operator.SumOperator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/exact/netket.exact.full_ed.html">
     netket.exact.full_ed
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/exact/netket.exact.lanczos_ed.html">
     netket.exact.lanczos_ed
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/exact/netket.exact.steady_state.html">
     netket.exact.steady_state
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.sampler_state.html">
     netket.sampler.sampler_state
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.reset.html">
     netket.sampler.reset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.sample_next.html">
     netket.sampler.sample_next
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.sample.html">
     netket.sampler.sample
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.samples.html">
     netket.sampler.samples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.Sampler.html">
     netket.sampler.Sampler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.ExactSampler.html">
     netket.sampler.ExactSampler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.MetropolisSampler.html">
     netket.sampler.MetropolisSampler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.MetropolisSamplerNumpy.html">
     netket.sampler.MetropolisSamplerNumpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.experimental.sampler.MetropolisPtSampler.html">
     netket.experimental.sampler.MetropolisPtSampler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.MetropolisLocal.html">
     netket.sampler.MetropolisLocal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.MetropolisExchange.html">
     netket.sampler.MetropolisExchange
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.MetropolisHamiltonian.html">
     netket.sampler.MetropolisHamiltonian
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.experimental.sampler.MetropolisLocalPt.html">
     netket.experimental.sampler.MetropolisLocalPt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.experimental.sampler.MetropolisExchangePt.html">
     netket.experimental.sampler.MetropolisExchangePt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.ARDirectSampler.html">
     netket.sampler.ARDirectSampler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.MetropolisRule.html">
     netket.sampler.MetropolisRule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.rules.LocalRule.html">
     netket.sampler.rules.LocalRule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.rules.ExchangeRule.html">
     netket.sampler.rules.ExchangeRule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.rules.HamiltonianRule.html">
     netket.sampler.rules.HamiltonianRule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.rules.HamiltonianRuleNumpy.html">
     netket.sampler.rules.HamiltonianRuleNumpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.rules.CustomRuleNumpy.html">
     netket.sampler.rules.CustomRuleNumpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.SamplerState.html">
     netket.sampler.SamplerState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/samplers/netket.sampler.MetropolisSamplerState.html">
     netket.sampler.MetropolisSamplerState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/models/netket.models.RBM.html">
     netket.models.RBM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/models/netket.models.RBMModPhase.html">
     netket.models.RBMModPhase
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/models/netket.models.RBMMultiVal.html">
     netket.models.RBMMultiVal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/models/netket.models.RBMSymm.html">
     netket.models.RBMSymm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/models/netket.models.Jastrow.html">
     netket.models.Jastrow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/models/netket.models.MPSPeriodic.html">
     netket.models.MPSPeriodic
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/models/netket.models.NDM.html">
     netket.models.NDM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/models/netket.models.GCNN.html">
     netket.models.GCNN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/models/netket.models.AbstractARNN.html">
     netket.models.AbstractARNN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/models/netket.models.ARNNDense.html">
     netket.models.ARNNDense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/models/netket.models.ARNNConv1D.html">
     netket.models.ARNNConv1D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/models/netket.models.ARNNConv2D.html">
     netket.models.ARNNConv2D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/models/netket.models.FastARNNConv1D.html">
     netket.models.FastARNNConv1D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/models/netket.models.FastARNNConv2D.html">
     netket.models.FastARNNConv2D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.Module.html">
     netket.nn.Module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.Dense.html">
     netket.nn.Dense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.DenseGeneral.html">
     netket.nn.DenseGeneral
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.DenseSymm.html">
     netket.nn.DenseSymm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.DenseEquivariant.html">
     netket.nn.DenseEquivariant
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.Conv.html">
     netket.nn.Conv
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.Embed.html">
     netket.nn.Embed
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.MaskedDense1D.html">
     netket.nn.MaskedDense1D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.MaskedConv1D.html">
     netket.nn.MaskedConv1D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.MaskedConv2D.html">
     netket.nn.MaskedConv2D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.celu.html">
     netket.nn.celu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.elu.html">
     netket.nn.elu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.gelu.html">
     netket.nn.gelu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.glu.html">
     netket.nn.glu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.log_sigmoid.html">
     netket.nn.log_sigmoid
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.log_softmax.html">
     netket.nn.log_softmax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.relu.html">
     netket.nn.relu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.sigmoid.html">
     netket.nn.sigmoid
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.soft_sign.html">
     netket.nn.soft_sign
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.softmax.html">
     netket.nn.softmax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.softplus.html">
     netket.nn.softplus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.swish.html">
     netket.nn.swish
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.log_cosh.html">
     netket.nn.log_cosh
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.reim_relu.html">
     netket.nn.reim_relu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/nn/netket.nn.reim_selu.html">
     netket.nn.reim_selu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/variational/netket.vqs.VariationalState.html">
     netket.vqs.VariationalState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/variational/netket.vqs.ExactState.html">
     netket.vqs.ExactState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/variational/netket.vqs.MCState.html">
     netket.vqs.MCState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/variational/netket.vqs.MCMixedState.html">
     netket.vqs.MCMixedState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/variational/netket.vqs.get_local_kernel.html">
     netket.vqs.get_local_kernel
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/variational/netket.vqs.get_local_kernel_arguments.html">
     netket.vqs.get_local_kernel_arguments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/optim/netket.optimizer.Adam.html">
     netket.optimizer.Adam
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/optim/netket.optimizer.AdaGrad.html">
     netket.optimizer.AdaGrad
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/optim/netket.optimizer.Sgd.html">
     netket.optimizer.Sgd
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/optim/netket.optimizer.Momentum.html">
     netket.optimizer.Momentum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/optim/netket.optimizer.RmsProp.html">
     netket.optimizer.RmsProp
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/optim/netket.optimizer.SR.html">
     netket.optimizer.SR
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/optim/netket.optimizer.qgt.QGTAuto.html">
     netket.optimizer.qgt.QGTAuto
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/optim/netket.optimizer.qgt.QGTOnTheFly.html">
     netket.optimizer.qgt.QGTOnTheFly
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/optim/netket.optimizer.qgt.QGTJacobianPyTree.html">
     netket.optimizer.qgt.QGTJacobianPyTree
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/optim/netket.optimizer.qgt.QGTJacobianDense.html">
     netket.optimizer.qgt.QGTJacobianDense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/optim/netket.optimizer.solver.svd.html">
     netket.optimizer.solver.svd
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/optim/netket.optimizer.solver.cholesky.html">
     netket.optimizer.solver.cholesky
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/optim/netket.optimizer.solver.LU.html">
     netket.optimizer.solver.LU
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/optim/netket.optimizer.solver.solve.html">
     netket.optimizer.solver.solve
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/driver/netket.driver.AbstractVariationalDriver.html">
     netket.driver.AbstractVariationalDriver
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/driver/netket.driver.VMC.html">
     netket.driver.VMC
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/driver/netket.driver.SteadyState.html">
     netket.driver.SteadyState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/driver/netket.logging.RuntimeLog.html">
     netket.logging.RuntimeLog
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/driver/netket.logging.JsonLog.html">
     netket.logging.JsonLog
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/driver/netket.logging.StateLog.html">
     netket.logging.StateLog
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/driver/netket.logging.TensorBoardLog.html">
     netket.logging.TensorBoardLog
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/utils/netket.utils.HashableArray.html">
     netket.utils.HashableArray
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/callbacks/netket.callbacks.EarlyStopping.html">
     netket.callbacks.EarlyStopping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/callbacks/netket.callbacks.Timeout.html">
     netket.callbacks.Timeout
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../docs/api-experimental.html">
   Experimental API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/samplers/netket.experimental.sampler.MetropolisPtSampler.html">
     netket.experimental.sampler.MetropolisPtSampler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/samplers/netket.experimental.sampler.MetropolisLocalPt.html">
     netket.experimental.sampler.MetropolisLocalPt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/samplers/netket.experimental.sampler.MetropolisExchangePt.html">
     netket.experimental.sampler.MetropolisExchangePt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/samplers/netket.experimental.sampler.MetropolisSamplerPmap.html">
     netket.experimental.sampler.MetropolisSamplerPmap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/variational/netket.experimental.vqs.variables_from_file.html">
     netket.experimental.vqs.variables_from_file
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/variational/netket.experimental.vqs.variables_from_tar.html">
     netket.experimental.vqs.variables_from_tar
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/dynamics/netket.experimental.driver.TDVP.html">
     netket.experimental.driver.TDVP
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Prerequisites">
   Prerequisites
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Defining-the-quantum-system">
   Defining the quantum system
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Defining-a-JAX-module-to-be-used-as-a-wave-function">
   Defining a JAX module to be used as a wave function
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Train-the-neural-network-to-find-an-approximate-ground-state">
   Train the neural network to find an approximate ground state
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Running-the-training-loop">
     Running the training loop
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Comparing-to-exact-diagonalization">
   Comparing to exact diagonalization
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Using-JAX-as-a-backend-in-NetKet---Feature-Preview-for-v3.0">
<h1>Using JAX as a backend in NetKet - Feature Preview for v3.0<a class="headerlink" href="#Using-JAX-as-a-backend-in-NetKet---Feature-Preview-for-v3.0" title="Permalink to this headline">Â¶</a></h1>
<p>In this tutorial we will show how differentiable functions (for example deep networks) written in <a class="reference external" href="https://github.com/google/jax">JAX</a> can be used as variational quantum states in NetKet.</p>
<p>This feature will be available in the upcoming major release (version 3.0). While version 3.0 is still in beta development, users can already try this feature.</p>
<div class="section" id="Prerequisites">
<h2>Prerequisites<a class="headerlink" href="#Prerequisites" title="Permalink to this headline">Â¶</a></h2>
<p>To try out integration with JAX, you first need to fetch the beta version of NetKet v3 We recommend using a virtual environment (either a python environment or a conda environment), for example</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python3 -m venv nk_env
<span class="nb">source</span> nk_env/bin/activate
pip install -U netket
</pre></div>
</div>
</div>
<div class="section" id="Defining-the-quantum-system">
<h2>Defining the quantum system<a class="headerlink" href="#Defining-the-quantum-system" title="Permalink to this headline">Â¶</a></h2>
<p>NetKet allows for full flexibility in defining quantum systems, for example when tackling a ground-state search problem. While there are a few pre-defined hamiltonians, it is relatively straightforward to implement new quantum operators/ Hamiltonians.</p>
<p>In the following, we consider the case of a transverse-field Ising model defined on a graph with random edges.</p>
<div class="math notranslate nohighlight">
\[H = -\sum_{i\in\textrm{nodes}}^{L} \sigma^x_{i} + J \sum_{(i,j)\in\textrm{edges}}\sigma_{i}^{z}\sigma_{j}^{z}\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># ensure we run on the CPU and not on the GPU
import os
os.environ[&quot;JAX_PLATFORM_NAME&quot;] = &quot;cpu&quot;

import netket as nk

#Define a random graph
n_nodes=10
n_edges=20
from numpy.random import choice
rand_edges=[choice(n_nodes, size=2,replace=False).tolist() for i in range(n_edges)]

graph=nk.graph.Graph(nodes=[i for i in range(n_nodes)], edges=rand_edges)

#Define the local hilbert space
hi=nk.hilbert.Spin(s=0.5)**graph.n_nodes

#Define the Hamiltonian as a sum of local operators
from netket.operator import LocalOperator as Op

# Pauli Matrices
sx = [[0, 1], [1, 0]]
sz = [[1, 0], [0, -1]]

# Defining the Hamiltonian as a LocalOperator acting on the given Hilbert space
ha = Op(hi)

#Adding a transverse field term on each node of the graph
for i in range(graph.n_nodes):
    ha += Op(hi, sx, [i])

#Adding nearest-neighbors interactions on the edges of the given graph
from numpy import kron
J=0.5
for edge in graph.edges():
    ha += J*Op(hi, kron(sz, sz), edge)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Defining-a-JAX-module-to-be-used-as-a-wave-function">
<h2>Defining a JAX module to be used as a wave function<a class="headerlink" href="#Defining-a-JAX-module-to-be-used-as-a-wave-function" title="Permalink to this headline">Â¶</a></h2>
<p>We now want to define a suitable JAX wave function to be used as a wave function ansatz. To simplify the discusssion, we consider here a simple single-layer fully connected network with complex weights and a <span class="math notranslate nohighlight">\(tanh\)</span> activation function. These are easy to define in JAX, using for example a model built with <code class="docutils literal notranslate"><span class="pre">`stax</span></code> &lt;<a class="reference external" href="https://jax.readthedocs.io/en/latest/jax.example_libraries.stax.html">https://jax.readthedocs.io/en/latest/jax.example_libraries.stax.html</a>&gt;`__. The only requirement is that these networks take as inputs JAX arrays of shape <code class="docutils literal notranslate"><span class="pre">(batch_size,n)</span></code>,
where batch_size is an arbitrary <code class="docutils literal notranslate"><span class="pre">batch</span> <span class="pre">size</span></code> and <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of quantum degrees of freedom (for example, the number of spins, in the previous example). Notice that regardless of the dimensionality of the problem, the last dimension is always flattened into a single index.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>import jax
from jax.example_libraries import stax
# NOTE: for JAX version prior to 0.2.25, use the following import instead:
# from jax.experimental import stax

#We define a custom layer that performs the sum of its inputs
def SumLayer():
    def init_fun(rng, input_shape):
        output_shape = (-1, 1)
        return output_shape, ()

    def apply_fun(params, inputs, **kwargs):
        return inputs.sum(axis=-1)

    return init_fun, apply_fun

#We construct a fully connected network with tanh activation
model=stax.serial(stax.Dense(2 * graph.n_nodes, W_init=nk.nn.initializers.normal(stddev=0.1, dtype=complex),
                             b_init=nk.nn.initializers.normal(stddev=0.1, dtype=complex)),
                  stax.Tanh,SumLayer())

# Alternatively, we could have used flax, which would have been easier:
#class Model(nk.nn.Module):
#    @nk.nn.compact
#    def __call__(self, x):
#        x = nk.nn.Dense(features=2*x.shape[-1], dtype=complex, kernel_init=nk.nn.initializers.normal(stddev=0.01), bias_init=nk.nn.initializers.normal(stddev=0.01))(x)
#        x = jax.numpy.tanh(x)
#        return jax.numpy.sum(x, axis=-1)
#model = Model()

# Alternatively #2 we could have used the built in RBM model:
#model = nk.models.RBM(alpha=2, use_visible_bias=False, dtype=np.complex128)
</pre></div>
</div>
</div>
</div>
<div class="section" id="Train-the-neural-network-to-find-an-approximate-ground-state">
<h2>Train the neural network to find an approximate ground state<a class="headerlink" href="#Train-the-neural-network-to-find-an-approximate-ground-state" title="Permalink to this headline">Â¶</a></h2>
<p>In order to perform Variational Monte Carlo, we further need to specify a suitable sampler (to compute expectation values over the variational state) as well as an optimizer. In the following we will adopt the Stochatic Gradient Descent coupled with quantum natural gradients (this scheme is known in the VMC literature as Stochastic Reconfiguration)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Defining a sampler that performs local moves
# NetKet automatically dispatches here to MCMC sampler written using JAX types
sa = nk.sampler.MetropolisLocal(hilbert=hi, n_chains=2)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Construct the variational state
vs = nk.variational.MCState(sa, model, n_samples=1000)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Using Sgd
# Also dispatching to JAX optimizer
op = nk.optimizer.Sgd(learning_rate=0.01)

# Using Stochastic Reconfiguration a.k.a. quantum natural gradient
# Also dispatching to a pure JAX version
sr = nk.optimizer.SR(diag_shift=0.01)

# Create the Variational Monte Carlo instance to learn the ground state
vmc = nk.VMC(
    hamiltonian=ha, optimizer=op, variational_state=vs, preconditioner=sr
)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="section" id="Running-the-training-loop">
<h3>Running the training loop<a class="headerlink" href="#Running-the-training-loop" title="Permalink to this headline">Â¶</a></h3>
<p>The last version of NetKet also allows for a finer control of the vmc loop. In the simplest case, one can just iterate through the vmc object and print the current value of the energy. More sophisticated output schemes based on tensorboard have been also implemented, but are not discussed in this Tutorial.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Running the learning loop and printing the energy every 50 steps
# [notice that the very first iteration is slow because of JIT compilation]
for it in vmc.iter(500,50):
    print(it,vmc.energy)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0 6.20-0.02j Â± 0.12 [ÏƒÂ²=13.25, RÌ‚=0.9994]
50 -5.98-0.06j Â± 0.14 [ÏƒÂ²=9.84, RÌ‚=0.9992]
100 -10.04-0.08j Â± 0.11 [ÏƒÂ²=10.24, RÌ‚=0.9995]
150 -10.907+0.014j Â± 0.042 [ÏƒÂ²=1.230, RÌ‚=1.0001]
200 -11.261-0.014j Â± 0.034 [ÏƒÂ²=0.855, RÌ‚=0.9993]
250 -11.396-0.013j Â± 0.024 [ÏƒÂ²=1.402, RÌ‚=0.9993]
300 -11.532+0.015j Â± 0.015 [ÏƒÂ²=0.198, RÌ‚=1.0000]
350 -11.727-0.002j Â± 0.019 [ÏƒÂ²=0.196, RÌ‚=1.0028]
400 -11.830-0.013j Â± 0.017 [ÏƒÂ²=0.105, RÌ‚=1.0051]
450 -11.872+0.011j Â± 0.010 [ÏƒÂ²=0.055, RÌ‚=0.9991]
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Comparing-to-exact-diagonalization">
<h2>Comparing to exact diagonalization<a class="headerlink" href="#Comparing-to-exact-diagonalization" title="Permalink to this headline">Â¶</a></h2>
<p>Since this is a relatively small quantum system, we can still diagonalize the Hamiltonian using exact diagonalization. For this purpose, NetKet conveniently exposes a <code class="docutils literal notranslate"><span class="pre">.to_sparse</span></code> method that just converts the Hamiltonian into a <code class="docutils literal notranslate"><span class="pre">scipy</span></code> sparse matrix. Here we first obtain this sparse matrix, and then diagonalize it with scipy builtins.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>import scipy
exact_ens=scipy.sparse.linalg.eigsh(ha.to_sparse(),k=1,which=&#39;SA&#39;,return_eigenvectors=False)
print(&quot;Exact energy is : &quot;,exact_ens[0])
print(&quot;Relative error is : &quot;, (abs((vmc.energy.mean-exact_ens[0])/exact_ens[0])))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Exact energy is :  -11.932889012463688
Relative error is :  0.0034391959338140226
</pre></div></div>
</div>
</div>
</div>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="netket3.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Ground-State Variational Search with NetKet</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="G-CNN_Honeycomb.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Using a group convolutional neural network to learn the ground-state of a symmetric spin model</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2019-2021, The Netket authors - All rights reserved.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br>
</p>
    </div>
    
  </div>
</footer>

<script type="text/javascript">
    jQuery(function () {
        SphinxRtdTheme.Navigation.enable(true);
      })
</script>

<!-- Temporary footer
<div class="footer-wip">
  <div class="footer-wip-content">
    This documentation refers to an unreleased version of Netket.
  </div>
</div>
-->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-118013987-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-118013987-1');
</script>

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "url": "https://www.netket.org",
  "name": "NetKet",
  "founder": "Giuseppe Carleo",
  "foundingDate": "2018-04-24",
  "foundingLocation" : "New York",
  "logo": "https://www.netket.org/img/logo_small.jpg",
  "sameAs": [
    "https://twitter.com/NetKetOrg",
    "https://github.com/NetKet/netket"
  ],
  "description" : "Netket is an open-source project delivering cutting-edge
  methods for the study of many-body quantum systems with artificial neural
  networks and machine learning techniques."
}
</script>

  </body>
</html>