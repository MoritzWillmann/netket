
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>The Variational State Interface &#8212; NetKet</title>
    
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    
  <link href="../_static/styles/sphinx-book-theme.css?digest=da817022793a90a681ee" rel="stylesheet">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Quantum Geometric Tensor and Stochastic Reconfiguration" href="sr.html" />
    <link rel="prev" title="The Operator module" href="operator.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
<!-- An invisible pixel that we watch to see if we've scrolled. -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint">
<!-- NAVBAR From boostrap 4.5 and old netket -->
  <nav class="navbar navbar-custom navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand navbar-custom-brand" href="../index.html">
                <span>
                  <img src="../_static/logonav.png" width="50" height="50" class="navbar-custom-logo d-inline-block align-center" alt="" loading="lazy">
                </span>
            NetKet</a>
      <span class="navbar-text navbar-version pull-left"><b></b></span>

      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
          <!-- Active class kept here for posterity
          <li class="nav-item active">
            <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
          </li>
          -->
          
              <li class="nav-item">
                <a class="nav-link" href="../getting_started.html">Get Started</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../citing.html">Citing NetKet</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../about.html">About</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../index.html">Documentation</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../api/api.html">API Reference</a>
              </li>
          
        </ul>
        <ul class="navbar-nav ml-auto">
          
              <li class="nav-item">
                <a class="nav-link" href="https://github.com/netket/netket"><i class="fab fa-github" aria-hidden="true"></i></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="https://twitter.com/NetKetOrg"><i class="fab fa-twitter" aria-hidden="true"></i></a>
              </li>
          
          
            <li class="nav-item">
              <a class="btn btn-outline-warning btn-download" href="../docs2/install.html">Install</a>
            </li>
          
        </ul>
      </div>
    </div>
  </nav>
<!-- /end NAVBAR From boostrap 4.5 and old netket --></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="pl-4 pr-3 bd-sidebar site-navigation noprint " id="site-navigation">
    <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo_simple.jpg" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../docs2/install.html">
   Installation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/j1j2.html">
   Ground-State: J1-J2 model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/G-CNN_Honeycomb.html">
   Symmetries: Honeycomb Heisenberg model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference Documentation
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="changelog.html">
   Change Log
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="superop.html">
   The Lindblad Master Equation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hilbert.html">
   The Hilbert module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="operator.html">
   The Operator module
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   The Variational State Interface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sr.html">
   Quantum Geometric Tensor and Stochastic Reconfiguration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="drivers.html">
   The Drivers API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sharp-bits.html">
   ðŸ”ª The Sharp Bits ðŸ”ª
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="api-stability.html">
   API Stability
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../api/api.html">
   Public API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/graph.html">
     netket.graph
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.AbstractGraph.html">
       netket.graph.AbstractGraph
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Graph.html">
       netket.graph.Graph
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Lattice.html">
       netket.graph.Lattice
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Edgeless.html">
       netket.graph.Edgeless
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Hypercube.html">
       netket.graph.Hypercube
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.lattice.LatticeSite.html">
       netket.graph.lattice.LatticeSite
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Grid.html">
       netket.graph.Grid
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Diamond.html">
       netket.graph.Diamond
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Kagome.html">
       netket.graph.Kagome
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Square.html">
       netket.graph.Square
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Chain.html">
       netket.graph.Chain
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Cube.html">
       netket.graph.Cube
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.BCC.html">
       netket.graph.BCC
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.FCC.html">
       netket.graph.FCC
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Honeycomb.html">
       netket.graph.Honeycomb
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.KitaevHoneycomb.html">
       netket.graph.KitaevHoneycomb
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Triangular.html">
       netket.graph.Triangular
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Pyrochlore.html">
       netket.graph.Pyrochlore
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.DoubledGraph.html">
       netket.graph.DoubledGraph
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.disjoint_union.html">
       netket.graph.disjoint_union
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/hilbert.html">
     netket.hilbert
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.AbstractHilbert.html">
       netket.hilbert.AbstractHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.ContinuousHilbert.html">
       netket.hilbert.ContinuousHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.DiscreteHilbert.html">
       netket.hilbert.DiscreteHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.HomogeneousHilbert.html">
       netket.hilbert.HomogeneousHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.CustomHilbert.html">
       netket.hilbert.CustomHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.TensorHilbert.html">
       netket.hilbert.TensorHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.DoubledHilbert.html">
       netket.hilbert.DoubledHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.Spin.html">
       netket.hilbert.Spin
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.Qubit.html">
       netket.hilbert.Qubit
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.Fock.html">
       netket.hilbert.Fock
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.Particle.html">
       netket.hilbert.Particle
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/operator.html">
     netket.operator
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.AbstractOperator.html">
       netket.operator.AbstractOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.AbstractSuperOperator.html">
       netket.operator.AbstractSuperOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.DiscreteOperator.html">
       netket.operator.DiscreteOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.BoseHubbard.html">
       netket.operator.BoseHubbard
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.GraphOperator.html">
       netket.operator.GraphOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.LocalOperator.html">
       netket.operator.LocalOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.Ising.html">
       netket.operator.Ising
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.Heisenberg.html">
       netket.operator.Heisenberg
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.PauliStrings.html">
       netket.operator.PauliStrings
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.LocalLiouvillian.html">
       netket.operator.LocalLiouvillian
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.boson.create.html">
       netket.operator.boson.create
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.boson.destroy.html">
       netket.operator.boson.destroy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.boson.number.html">
       netket.operator.boson.number
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.boson.proj.html">
       netket.operator.boson.proj
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmax.html">
       netket.operator.spin.sigmax
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmay.html">
       netket.operator.spin.sigmay
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmaz.html">
       netket.operator.spin.sigmaz
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmap.html">
       netket.operator.spin.sigmap
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmam.html">
       netket.operator.spin.sigmam
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.ContinuousOperator.html">
       netket.operator.ContinuousOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.KineticEnergy.html">
       netket.operator.KineticEnergy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.PotentialEnergy.html">
       netket.operator.PotentialEnergy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.SumOperator.html">
       netket.operator.SumOperator
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/exact.html">
     netket.exact
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/exact/netket.exact.full_ed.html">
       netket.exact.full_ed
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/exact/netket.exact.lanczos_ed.html">
       netket.exact.lanczos_ed
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/exact/netket.exact.steady_state.html">
       netket.exact.steady_state
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/sampler.html">
     netket.sampler
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.Sampler.html">
       netket.sampler.Sampler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.SamplerState.html">
       netket.sampler.SamplerState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisSamplerState.html">
       netket.sampler.MetropolisSamplerState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisRule.html">
       netket.sampler.MetropolisRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.ExactSampler.html">
       netket.sampler.ExactSampler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisSampler.html">
       netket.sampler.MetropolisSampler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisSamplerNumpy.html">
       netket.sampler.MetropolisSamplerNumpy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.ARDirectSampler.html">
       netket.sampler.ARDirectSampler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisLocal.html">
       netket.sampler.MetropolisLocal
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisExchange.html">
       netket.sampler.MetropolisExchange
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisHamiltonian.html">
       netket.sampler.MetropolisHamiltonian
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisRule.html">
       netket.sampler.MetropolisRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.LocalRule.html">
       netket.sampler.rules.LocalRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.ExchangeRule.html">
       netket.sampler.rules.ExchangeRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.HamiltonianRule.html">
       netket.sampler.rules.HamiltonianRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.HamiltonianRuleNumpy.html">
       netket.sampler.rules.HamiltonianRuleNumpy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.CustomRuleNumpy.html">
       netket.sampler.rules.CustomRuleNumpy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.SamplerState.html">
       netket.sampler.SamplerState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisSamplerState.html">
       netket.sampler.MetropolisSamplerState
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/models.html">
     netket.models
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.RBM.html">
       netket.models.RBM
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.RBMModPhase.html">
       netket.models.RBMModPhase
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.RBMMultiVal.html">
       netket.models.RBMMultiVal
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.RBMSymm.html">
       netket.models.RBMSymm
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.Jastrow.html">
       netket.models.Jastrow
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.MPSPeriodic.html">
       netket.models.MPSPeriodic
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.NDM.html">
       netket.models.NDM
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.GCNN.html">
       netket.models.GCNN
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.AbstractARNN.html">
       netket.models.AbstractARNN
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.ARNNDense.html">
       netket.models.ARNNDense
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.ARNNConv1D.html">
       netket.models.ARNNConv1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.ARNNConv2D.html">
       netket.models.ARNNConv2D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.FastARNNConv1D.html">
       netket.models.FastARNNConv1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.FastARNNConv2D.html">
       netket.models.FastARNNConv2D
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/nn.html">
     netket.nn
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.Dense.html">
       netket.nn.Dense
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.DenseGeneral.html">
       netket.nn.DenseGeneral
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.DenseSymm.html">
       netket.nn.DenseSymm
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.DenseEquivariant.html">
       netket.nn.DenseEquivariant
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.Conv.html">
       netket.nn.Conv
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.Embed.html">
       netket.nn.Embed
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.MaskedDense1D.html">
       netket.nn.MaskedDense1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.MaskedConv1D.html">
       netket.nn.MaskedConv1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.MaskedConv2D.html">
       netket.nn.MaskedConv2D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.celu.html">
       netket.nn.celu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.elu.html">
       netket.nn.elu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.gelu.html">
       netket.nn.gelu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.glu.html">
       netket.nn.glu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.log_sigmoid.html">
       netket.nn.log_sigmoid
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.log_softmax.html">
       netket.nn.log_softmax
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.relu.html">
       netket.nn.relu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.sigmoid.html">
       netket.nn.sigmoid
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.soft_sign.html">
       netket.nn.soft_sign
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.softmax.html">
       netket.nn.softmax
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.softplus.html">
       netket.nn.softplus
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.swish.html">
       netket.nn.swish
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.log_cosh.html">
       netket.nn.log_cosh
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.reim_relu.html">
       netket.nn.reim_relu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.reim_selu.html">
       netket.nn.reim_selu
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/jax.html">
     netket.jax
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.HashablePartial.html">
       netket.jax.HashablePartial
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.PRNGKey.html">
       netket.jax.PRNGKey
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.PRNGSeq.html">
       netket.jax.PRNGSeq
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.mpi_split.html">
       netket.jax.mpi_split
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_dot.html">
       netket.jax.tree_dot
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_axpy.html">
       netket.jax.tree_axpy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_cast.html">
       netket.jax.tree_cast
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_conj.html">
       netket.jax.tree_conj
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_size.html">
       netket.jax.tree_size
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_leaf_iscomplex.html">
       netket.jax.tree_leaf_iscomplex
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_ishomogeneous.html">
       netket.jax.tree_ishomogeneous
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_ravel.html">
       netket.jax.tree_ravel
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_to_real.html">
       netket.jax.tree_to_real
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.dtype_complex.html">
       netket.jax.dtype_complex
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.is_complex.html">
       netket.jax.is_complex
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.is_complex_dtype.html">
       netket.jax.is_complex_dtype
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.maybe_promote_to_complex.html">
       netket.jax.maybe_promote_to_complex
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.expect.html">
       netket.jax.expect
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.vjp.html">
       netket.jax.vjp
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.chunk.html">
       netket.jax.chunk
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.unchunk.html">
       netket.jax.unchunk
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.vjp_chunked.html">
       netket.jax.vjp_chunked
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.vmap_chunked.html">
       netket.jax.vmap_chunked
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/vqs.html">
     netket.vqs
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.VariationalState.html">
       netket.vqs.VariationalState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.ExactState.html">
       netket.vqs.ExactState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCState.html">
       netket.vqs.MCState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCMixedState.html">
       netket.vqs.MCMixedState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.get_local_kernel.html">
       netket.vqs.get_local_kernel
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.get_local_kernel_arguments.html">
       netket.vqs.get_local_kernel_arguments
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/optimizer.html">
     netket.optimizer
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.Adam.html">
       netket.optimizer.Adam
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.AdaGrad.html">
       netket.optimizer.AdaGrad
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.Sgd.html">
       netket.optimizer.Sgd
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.Momentum.html">
       netket.optimizer.Momentum
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.RmsProp.html">
       netket.optimizer.RmsProp
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.SR.html">
       netket.optimizer.SR
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.qgt.QGTAuto.html">
       netket.optimizer.qgt.QGTAuto
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.qgt.QGTOnTheFly.html">
       netket.optimizer.qgt.QGTOnTheFly
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.qgt.QGTJacobianPyTree.html">
       netket.optimizer.qgt.QGTJacobianPyTree
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.qgt.QGTJacobianDense.html">
       netket.optimizer.qgt.QGTJacobianDense
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.solver.svd.html">
       netket.optimizer.solver.svd
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.solver.cholesky.html">
       netket.optimizer.solver.cholesky
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.solver.LU.html">
       netket.optimizer.solver.LU
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.solver.solve.html">
       netket.optimizer.solver.solve
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/logging.html">
     netket.logging
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/driver/netket.logging.RuntimeLog.html">
       netket.logging.RuntimeLog
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/driver/netket.logging.JsonLog.html">
       netket.logging.JsonLog
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/driver/netket.logging.StateLog.html">
       netket.logging.StateLog
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/driver/netket.logging.TensorBoardLog.html">
       netket.logging.TensorBoardLog
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/callbacks.html">
     netket.callbacks
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
    <label for="toctree-checkbox-13">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/callbacks/netket.callbacks.EarlyStopping.html">
       netket.callbacks.EarlyStopping
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/callbacks/netket.callbacks.Timeout.html">
       netket.callbacks.Timeout
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/utils.html">
     netket.utils
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.HashableArray.html">
       netket.utils.HashableArray
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.available.html">
       netket.utils.mpi.available
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.n_nodes.html">
       netket.utils.mpi.n_nodes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.rank.html">
       netket.utils.mpi.rank
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.MPI_jax_comm.html">
       netket.utils.mpi.MPI_jax_comm
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.MPI_py_comm.html">
       netket.utils.mpi.MPI_py_comm
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="api-experimental.html">
   Experimental API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/samplers/netket.experimental.sampler.MetropolisPtSampler.html">
     netket.experimental.sampler.MetropolisPtSampler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/samplers/netket.experimental.sampler.MetropolisLocalPt.html">
     netket.experimental.sampler.MetropolisLocalPt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/samplers/netket.experimental.sampler.MetropolisExchangePt.html">
     netket.experimental.sampler.MetropolisExchangePt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/samplers/netket.experimental.sampler.MetropolisSamplerPmap.html">
     netket.experimental.sampler.MetropolisSamplerPmap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/variational/netket.experimental.vqs.variables_from_file.html">
     netket.experimental.vqs.variables_from_file
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/variational/netket.experimental.vqs.variables_from_tar.html">
     netket.experimental.vqs.variables_from_tar
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/dynamics/netket.experimental.driver.TDVP.html">
     netket.experimental.driver.TDVP
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Developer Documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="contributing.html">
   Contributing to NetKet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="writing-tests.html">
   Writing Tests
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        


<div class="col py-1 d-flex topbar-main">
    <div class="topbar-left">
        
        <label class="nav-toggle-button topbarbtn" for="__navigation">
            <div class="visually-hidden">Toggle navigation</div>
            <i class="fas fa-bars"></i>
        </label>
        
    </div>
    <div class="topbar-right">
        <!-- Launch buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/netket/netket"><button type="button" class="topbarbtn--wide"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/netket/netket/issues/new?title=Issue%20on%20page%20%2Fdocs/varstate.html&body=Your%20issue%20content%20here."><button
                type="button" class="topbarbtn--wide" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

        
<div class="dropdown-buttons-trigger sb-download-buttons">
    <button id="dropdown-buttons-trigger" class="topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/docs/varstate.md.txt"><button type="button"
                class="topbarbtn--wide" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="topbarbtn--wide" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <label class="d-block d-md-none nav-toggle-button topbarbtn" for="__page-toc">
  <div class="visually-hidden">Toggle Table of Contents</div>
  <i class="fas fa-list"></i>
</label>
    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#constructing-a-variational-state">
   Constructing a Variational State
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#defining-models-flax">
     Defining models: Flax
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mcstate">
     MCState
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-a-monte-carlo-variational-state">
   Using a Monte Carlo Variational State
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#expectation-values">
     Expectation values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sampling">
     Sampling
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#collecting-the-state-vector">
     Collecting the state-vector
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#manipulating-the-parameters">
     Manipulating the parameters
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#saving-and-loading-a-variational-state">
   Saving and Loading a Variational State
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-exactstate-for-testing">
   Using ExactState for testing
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>The Variational State Interface</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#constructing-a-variational-state">
   Constructing a Variational State
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#defining-models-flax">
     Defining models: Flax
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mcstate">
     MCState
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-a-monte-carlo-variational-state">
   Using a Monte Carlo Variational State
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#expectation-values">
     Expectation values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sampling">
     Sampling
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#collecting-the-state-vector">
     Collecting the state-vector
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#manipulating-the-parameters">
     Manipulating the parameters
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#saving-and-loading-a-variational-state">
   Saving and Loading a Variational State
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-exactstate-for-testing">
   Using ExactState for testing
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="the-variational-state-interface">
<h1>The Variational State Interface<a class="headerlink" href="#the-variational-state-interface" title="Permalink to this headline">Â¶</a></h1>
<p>A central element of NetKet is the <a class="reference internal" href="../api/_generated/vqs/netket.vqs.VariationalState.html#netket.vqs.VariationalState" title="netket.vqs.VariationalState"><code class="xref py py-class docutils literal notranslate"><span class="pre">VariationalState</span></code></a> interface.
A Variational State represents an approximate, variational description of a system, and can be used to
probe it.</p>
<p>As of now, NetKet has two types of Variational state implementations:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCState.html#netket.vqs.MCState" title="netket.vqs.MCState"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCState</span></code></a>, which is a classical variational approximation of a pure state.</p></li>
<li><p><a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCMixedState.html#netket.vqs.MCMixedState" title="netket.vqs.MCMixedState"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCMixedState</span></code></a>, which is a classical variational approximation of a mixed state.</p></li>
</ul>
<p>It is our plan to build upon this interface for new kind of variational states in the future. For example, we
are interested in implementing a new kind of variational state that encodes a state into a Qiskit circuit.</p>
<section id="constructing-a-variational-state">
<h2>Constructing a Variational State<a class="headerlink" href="#constructing-a-variational-state" title="Permalink to this headline">Â¶</a></h2>
<p>To construct the two variational states above you need to provide at least a Monte Carlo sampler (you can see
the list of available ones <span class="xref std std-ref">here</span>) and a model.
The hilbert space of the variational state will be inferred from the sampler, as they all reference the
hilbert space they are sampling.</p>
<p>The model can be specified in several ways. The most standard way is to pass a <a class="reference external" href="https://flax.readthedocs.io/en/latest/flax.linen.html#module">Flax Linen Module</a>, but you can also pass a Jax-style pair
of functions <code class="code docutils literal notranslate"><span class="pre">(init,</span> <span class="pre">apply)</span></code> or an haiku module obtained by calling <code class="code docutils literal notranslate"><span class="pre">haiku.transform()</span></code>.
Itâ€™s also easy to use another jax-based framework with NetKet (though itâ€™s not yet documented). If you
want to do that, you can have a look at the automatic conversion <a class="reference external" href="https://github.com/netket/netket/tree/master/netket/utils/model_frameworks">code</a> and get in touch with us.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Initializing a Variational State with non-Flax modules is still experimental. Complex modules,
especially if mutable, might not work. If you have problems donâ€™t hesitate opening issues on
GitHub so that we can address them. They are mostly easy fixes.</p>
</div>
<section id="defining-models-flax">
<h3>Defining models: Flax<a class="headerlink" href="#defining-models-flax" title="Permalink to this headline">Â¶</a></h3>
<p>In general, the most-well supported way to define Models for NetKet is through Flax.</p>
<p>If you are not familiar with Flax, itâ€™s a package that allows to define Neural Networks or other
parametrized functions. While we suggest to read carefully the <a class="reference external" href="https://flax.readthedocs.io/en/latest/notebooks/flax_basics.html">introduction to Flax</a>, if you are impatient and just want to define some simple, easy
models you can find some examples in the <a class="reference external" href="https://flax.readthedocs.io/en/latest/howtos/model_surgery.html">Model Surgery</a> section of Flax documentation.</p>
<p>Other examples can be found in the source of the <span class="xref std std-ref">Pre-built models</span> distributed with NetKet, such as
<a class="reference internal" href="../api/_generated/models/netket.models.RBM.html#netket.models.RBM" title="netket.models.RBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">RBM</span></code></a> (the simplest one), <a class="reference internal" href="../api/_generated/models/netket.models.MPSPeriodic.html#netket.models.MPSPeriodic" title="netket.models.MPSPeriodic"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPSPeriodic</span></code></a> and <a class="reference internal" href="../api/_generated/models/netket.models.NDM.html#netket.models.NDM" title="netket.models.NDM"><code class="xref py py-class docutils literal notranslate"><span class="pre">NDM</span></code></a> for
more complicated examples.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Flax modules do not always work well with complex numbers. For that reason, if your model has complex
parameters we invite you to use <code class="code docutils literal notranslate"><span class="pre">netket.nn</span></code> in place of <code class="code docutils literal notranslate"><span class="pre">flax.linen</span></code> and <code class="code docutils literal notranslate"><span class="pre">flax.nn</span></code>.</p>
<p><code class="code docutils literal notranslate"><span class="pre">netket.nn</span></code> re-exports some Flax functionality ensuring that it works nicely with complex numbers.
If you donâ€™t find something from Flax in <code class="code docutils literal notranslate"><span class="pre">netket.nn</span></code>, please <a class="reference external" href="https://github.com/netket/netket/issues">open an issue</a> in GitHub.</p>
</div>
</section>
<section id="mcstate">
<h3>MCState<a class="headerlink" href="#mcstate" title="Permalink to this headline">Â¶</a></h3>
<p>Letâ€™s now assume we have a Flax module, <a class="reference internal" href="../api/_generated/models/netket.models.RBM.html#netket.models.RBM" title="netket.models.RBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">RBM</span></code></a> and we want to construct a variational state
on sampled with a simple <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisLocal.html#netket.sampler.MetropolisLocal" title="netket.sampler.MetropolisLocal"><code class="xref py py-func docutils literal notranslate"><span class="pre">MetropolisLocal()</span></code></a> sampler.</p>
<p>To do this, first you need to construct the model and the sampler, and then you can pass them, together with several
parameters, to the constructor.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hilbert</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">hilbert</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">**</span><span class="mi">10</span>

<span class="n">sampler</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">MetropolisLocal</span><span class="p">(</span><span class="n">hilbert</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">RBM</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">kernel_init</span><span class="o">=</span><span class="n">nk</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">stddev</span><span class="o">=</span><span class="mf">0.01</span><span class="p">))</span>

<span class="n">vstate</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">vqs</span><span class="o">.</span><span class="n">MCState</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
<p>When constructed, the variational state will call the modelâ€™s init method to generate the state and the
parameters, and will also initialize the sampler.</p>
<p>When constructing a variational state you can also pass a seed, that will be used to initialize both the
weights and the sampler. You can also pass two different seeds for the sampler and the weights.</p>
<div class="admonition warning" id="warn-chunking">
<p class="admonition-title">Warning</p>
<p>Sometimes you might be working on very large models that run on GPUs, or you might want to compute expectaion values with a very high number of samples, which might cause out-of-memory errors. To prevent this, <code class="code docutils literal notranslate"><span class="pre">MCState</span></code> exposes the attribute <a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCState.html#netket.vqs.MCState.chunk_size" title="netket.vqs.MCState.chunk_size"><code class="xref py py-attr docutils literal notranslate"><span class="pre">chunk_size</span></code></a>, which controls the size of the chunks used in the forward and backward computation of expectation values.</p>
<p>When this value is set, computations are not performed on huge matrices, but instead we split the inputs into smaller matrices and loop through them. In general, setting <a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCState.html#netket.vqs.MCState.chunk_size" title="netket.vqs.MCState.chunk_size"><code class="xref py py-attr docutils literal notranslate"><span class="pre">chunk_size</span></code></a> to a low value will address the majority of memory issues, but will increase the computational cost.</p>
<p>A value of at least 128 is suggested, but will geatly depend on your model. You should try to use the largest value you can for your system. Setting it to <code class="code docutils literal notranslate"><span class="pre">None</span></code> is equivalent to setting it to infinity.</p>
</div>
</section>
</section>
<section id="using-a-monte-carlo-variational-state">
<h2>Using a Monte Carlo Variational State<a class="headerlink" href="#using-a-monte-carlo-variational-state" title="Permalink to this headline">Â¶</a></h2>
<section id="expectation-values">
<h3>Expectation values<a class="headerlink" href="#expectation-values" title="Permalink to this headline">Â¶</a></h3>
<p>One you have a variational state, you can do many things with it.
First of all, you can probe expectation values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>HÌ‚ = nk.operator.Ising(hilbert, nk.graph.Chain(hilbert.size), h=0.5)

vstate.expect(HÌ‚)

&gt;&gt;&gt; -4.98 Â± 0.14 [ÏƒÂ²=9.51, RÌ‚=1.0006]
</pre></div>
</div>
<p>Notice that if you call multiple times <code class="code docutils literal notranslate"><span class="pre">expect</span></code>, the same set of
samples will be used, and you will get the same result. To force sampling
to happen again, you can call <a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCState.html#netket.vqs.MCState.sample" title="netket.vqs.MCState.sample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample()</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>vstate.expect(HÌ‚)

&gt;&gt;&gt; -4.98 Â± 0.14 [ÏƒÂ²=9.51, RÌ‚=1.0006]

vstate.sample();

vstate.expect(HÌ‚)

&gt;&gt;&gt; -4.90 Â± 0.14 [ÏƒÂ²=9.54, RÌ‚=1.0062]
</pre></div>
</div>
<p>The set of the last sampled samples can be accessed from the attribute
<a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCState.html#netket.vqs.MCState.samples" title="netket.vqs.MCState.samples"><code class="xref py py-attr docutils literal notranslate"><span class="pre">samples</span></code></a>. If you access the samples
from this attribute, but you havenâ€™t sampled already, <code class="code docutils literal notranslate"><span class="pre">sample()</span></code> will
be called automatically.</p>
<p>Note that when you update the parameters, the samples are automatically
discarded.</p>
<p>Parameters can be accessed through the attribute <a class="reference internal" href="../api/_generated/vqs/netket.vqs.VariationalState.html#netket.vqs.VariationalState.parameters" title="netket.vqs.VariationalState.parameters"><code class="xref py py-attr docutils literal notranslate"><span class="pre">parameters</span></code></a>,
and you can modify them by assigning a new set of parameters to this attribute.</p>
<p>Note that parameters cannot in general be modified in place, as they are
of type <code class="docutils literal notranslate"><span class="pre">FrozenDict</span></code> (they are frozen, aka canâ€™t be modified). A typical way
to modify them, for example to add 0.1 to all parameters is to do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jax</span>

<span class="c1"># See the value of some parameters</span>
<span class="n">vstate</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;visible_bias&#39;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">DeviceArray</span><span class="p">([</span><span class="o">-</span><span class="mf">0.10806808</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.14987472</span><span class="p">,</span>  <span class="mf">0.13069461</span><span class="p">,</span>  <span class="mf">0.0125838</span> <span class="p">,</span>
              <span class="mf">0.06278384</span><span class="p">,</span>  <span class="mf">0.00275547</span><span class="p">,</span>  <span class="mf">0.05843748</span><span class="p">,</span>  <span class="mf">0.07516951</span><span class="p">,</span>
              <span class="mf">0.21897993</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01632223</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)</span>

<span class="n">vstate</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">vstate</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>

<span class="c1"># Look at the new values</span>
<span class="n">vstate</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;visible_bias&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">DeviceArray</span><span class="p">([</span><span class="o">-</span><span class="mf">0.00806808</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04987472</span><span class="p">,</span>  <span class="mf">0.23069461</span><span class="p">,</span>  <span class="mf">0.1125838</span> <span class="p">,</span>
              <span class="mf">0.16278384</span><span class="p">,</span>  <span class="mf">0.10275547</span><span class="p">,</span>  <span class="mf">0.15843748</span><span class="p">,</span>  <span class="mf">0.17516951</span><span class="p">,</span>
              <span class="mf">0.31897993</span><span class="p">,</span>  <span class="mf">0.08367777</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="sampling">
<h3>Sampling<a class="headerlink" href="#sampling" title="Permalink to this headline">Â¶</a></h3>
<p>You can also change the number of samples to extract (note: this will
trigger recompilation of the sample function, so you should not do this
in a hot loop) by changing <a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCState.html#netket.vqs.MCState.n_samples" title="netket.vqs.MCState.n_samples"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_samples</span></code></a>, and
the number of discarded samples at the beginning of every markov chain by
changing <a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCState.html#netket.vqs.MCState.n_discard_per_chain" title="netket.vqs.MCState.n_discard_per_chain"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_discard_per_chain</span></code></a>.</p>
<p>By default, <a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCState.html#netket.vqs.MCState.n_discard_per_chain" title="netket.vqs.MCState.n_discard_per_chain"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_discard_per_chain</span></code></a> is 10% of
<a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCState.html#netket.vqs.MCState.n_samples" title="netket.vqs.MCState.n_samples"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_samples</span></code></a>.</p>
<p>The number of samples is then split among the number of chains/batches of the sampler.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hilbert</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">hilbert</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">**</span><span class="mi">6</span>

<span class="n">sampler</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">MetropolisLocal</span><span class="p">(</span><span class="n">hilbert</span><span class="p">,</span> <span class="n">n_chains</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">vstate</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">vqs</span><span class="o">.</span><span class="n">MCState</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">nk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">RBM</span><span class="p">(),</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">vstate</span><span class="o">.</span><span class="n">n_samples</span><span class="p">)</span>
<span class="mi">504</span>

<span class="nb">print</span><span class="p">(</span><span class="n">vstate</span><span class="o">.</span><span class="n">chain_length</span><span class="p">)</span>
<span class="mi">63</span>

<span class="nb">print</span><span class="p">(</span><span class="n">vstate</span><span class="o">.</span><span class="n">n_discard_per_chain</span><span class="p">)</span>
<span class="mi">50</span>
</pre></div>
</div>
<p>You can see that 500 samples are split among 8 chains, giving <span class="math notranslate nohighlight">\(500/8=62.5\)</span> (rounded to
the next largest integer, 63). Therefore 8 chains of length 63 will be run.
n_discard_per_chain gives the number of discarded steps taken in the markov chain before actually storing
them, so the Markov Chains are actually <code class="code docutils literal notranslate"><span class="pre">chain_length</span> <span class="pre">+</span> <span class="pre">n_discard_per_chain</span></code> long. The default
n_discard_per_chain is 10% of the total samples, but you can change that to any number.</p>
<div class="admonition warning" id="warn-mpi-sampling">
<p class="admonition-title">Warning</p>
<p>When running your code under MPI, the length of the chain is computed not only by dividing the
total number of samples by <code class="code docutils literal notranslate"><span class="pre">n_chains</span></code>, but also by diving it by the number of MPI processes.</p>
<p>Therefore, considering the number from the example above, if we had 4 MPI processes, we would have
found a chain length of <span class="math notranslate nohighlight">\(500/(8*4) = 15.625 \rightarrow 16\)</span>.</p>
</div>
</section>
<section id="collecting-the-state-vector">
<h3>Collecting the state-vector<a class="headerlink" href="#collecting-the-state-vector" title="Permalink to this headline">Â¶</a></h3>
<p>A variational state can be evaluated on the whole Hilbert space in order to obtain
the ket it represents.</p>
<p>This is achieved by using the <a class="reference internal" href="../api/_generated/vqs/netket.vqs.VariationalState.html#netket.vqs.VariationalState.to_array" title="netket.vqs.VariationalState.to_array"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_array()</span></code></a> method,
which by defaults normalises the <span class="math notranslate nohighlight">\(L_2\)</span> norm of the vector to 1 (but can be turned off).</p>
<p>Mixed state ansatzes can be converted to their matrix representation with
<a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCMixedState.html#netket.vqs.MCMixedState.to_matrix" title="netket.vqs.MCMixedState.to_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_matrix()</span></code></a>. In this case, the default
normalisation sets the trace to 1.</p>
</section>
<section id="manipulating-the-parameters">
<h3>Manipulating the parameters<a class="headerlink" href="#manipulating-the-parameters" title="Permalink to this headline">Â¶</a></h3>
<p>You can access the parameters of a variational state through the <a class="reference internal" href="../api/_generated/vqs/netket.vqs.VariationalState.html#netket.vqs.VariationalState.parameters" title="netket.vqs.VariationalState.parameters"><code class="xref py py-attr docutils literal notranslate"><span class="pre">parameters</span></code></a> attribute.
Similarly, if your model has also a mutable state, you can access it through
the <a class="reference internal" href="../api/_generated/vqs/netket.vqs.VariationalState.html#netket.vqs.VariationalState.model_state" title="netket.vqs.VariationalState.model_state"><code class="xref py py-attr docutils literal notranslate"><span class="pre">model_state</span></code></a> attribute.</p>
<p>Parameters are stored as a Flax <code class="code docutils literal notranslate"><span class="pre">FrozenDict</span></code>, which behaves like a standard python dictionary but cannot be modified.
In Jax jargon, Parameters are a PyTree (see <a class="reference external" href="https://jax.readthedocs.io/en/latest/pytrees.html">PyTree documentation</a>) and they
can be operated upon with functions like <a class="reference external" href="https://jax.readthedocs.io/en/latest/jax.tree_util.html?highlight=tree_map#jax.tree_util.tree_map">jax.tree_map</a>.</p>
<p>You can also modify the parameters by _unfreezing_ them, using the command <code class="docutils literal notranslate"><span class="pre">flax.core.unfreeze</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">flax</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">flax</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">(</span><span class="n">varstate</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>

<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;Dense&#39;</span><span class="p">][</span><span class="s1">&#39;kernel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;Dense&#39;</span><span class="p">][</span><span class="s1">&#39;kernel&#39;</span><span class="p">]</span> <span class="o">+</span><span class="mi">1</span>

<span class="n">varstate</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">pars</span>
</pre></div>
</div>
<p>The parameter dict will be automatically frozen upon assignment.</p>
</section>
</section>
<section id="saving-and-loading-a-variational-state">
<h2>Saving and Loading a Variational State<a class="headerlink" href="#saving-and-loading-a-variational-state" title="Permalink to this headline">Â¶</a></h2>
<p>Variational States conform to the <a class="reference external" href="https://flax.readthedocs.io/en/latest/flax.serialization.html">Flax serialization interface</a> and can be serialized and deserialized with it.</p>
<p>Moreover, the Json Logger <a class="reference internal" href="../api/_generated/driver/netket.logging.JsonLog.html#netket.logging.JsonLog" title="netket.logging.JsonLog"><code class="xref py py-class docutils literal notranslate"><span class="pre">JsonLog</span></code></a> serializes the variational state
through that interface.</p>
<p>A simple example to serialize data is provided below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># construct an RBM model on 10 spins</span>
<span class="n">vstate</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">vqs</span><span class="o">.</span><span class="n">MCState</span><span class="p">(</span><span class="n">nk</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">MetropolisLocal</span><span class="p">(</span><span class="n">nk</span><span class="o">.</span><span class="n">hilbert</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">**</span><span class="mi">10</span><span class="p">),</span>
                                <span class="n">nk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">RBM</span><span class="p">())</span>

<span class="kn">import</span> <span class="nn">flax</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;test.mpack&quot;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
  <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">flax</span><span class="o">.</span><span class="n">serialization</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">vstate</span><span class="p">))</span>
</pre></div>
</div>
<p>And here we de-serialize it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># construct a new RBM model on 10 spins</span>
<span class="n">vstate</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">vqs</span><span class="o">.</span><span class="n">MCState</span><span class="p">(</span><span class="n">nk</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">MetropolisLocal</span><span class="p">(</span><span class="n">nk</span><span class="o">.</span><span class="n">hilbert</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">**</span><span class="mi">10</span><span class="p">),</span>
                                <span class="n">nk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">RBM</span><span class="p">())</span>

<span class="c1"># load</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;test.mpack&quot;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
  <span class="n">vstate</span> <span class="o">=</span> <span class="n">flax</span><span class="o">.</span><span class="n">serialization</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">vstate</span><span class="p">,</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
<p>Note that this also serializes the state of the sampler.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The JSonLog serializer only serializes the parameters of the model, and not the whole variational state.
Therefore, if you wish to reload the parameters of a variational state, saved by the json logger, you should
use the same procedure outlined above, only that the list line should be:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;parameters.mpack&quot;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
  <span class="n">vstate</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="n">flax</span><span class="o">.</span><span class="n">serialization</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">vstate</span><span class="o">.</span><span class="n">variables</span><span class="p">,</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
</div>
</section>
<section id="using-exactstate-for-testing">
<h2>Using ExactState for testing<a class="headerlink" href="#using-exactstate-for-testing" title="Permalink to this headline">Â¶</a></h2>
<p>In order to check the performance of a given model on small test systems, it is possible to use <code class="xref py py-class docutils literal notranslate"><span class="pre">ExactState</span></code> which can be used in place of <a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCState.html#netket.vqs.MCState" title="netket.vqs.MCState"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCState</span></code></a> and computes quantities not by stochastic sampling but by evaluation of the ansatz over the full Hilbert space basis. (Therefore, it is infeasible to use for system sizes beyond ED.)
This can be helpful to diagnose potential errors arising from Monte Carlo sampling.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">vs</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">vqs</span><span class="o">.</span><span class="n">ExactState</span><span class="p">(</span><span class="n">hilbert</span><span class="p">,</span> <span class="n">nk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">RBM</span><span class="p">())</span>
</pre></div>
</div>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="operator.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">The Operator module</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="sr.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Quantum Geometric Tensor and Stochastic Reconfiguration</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Giuseppe Carleo et al.<br/>
  
      &copy; Copyright 2019-2021, The Netket authors - All rights reserved.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  
  <script src="../_static/scripts/sphinx-book-theme.js?digest=da817022793a90a681ee"></script>


  </body>
</html>