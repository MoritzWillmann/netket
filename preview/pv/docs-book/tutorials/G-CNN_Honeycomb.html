
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Symmetries: Honeycomb Heisenberg model &#8212; NetKet</title>
    
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    
  <link href="../_static/styles/sphinx-book-theme.css?digest=da817022793a90a681ee" rel="stylesheet">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Change Log" href="../docs/changelog.html" />
    <link rel="prev" title="Ground-State: J1-J2 model" href="j1j2.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
<!-- An invisible pixel that we watch to see if we've scrolled. -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint">
<!-- NAVBAR From boostrap 4.5 and old netket -->
  <nav class="navbar navbar-custom navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand navbar-custom-brand" href="../index.html">
                <span>
                  <img src="../_static/logonav.png" width="50" height="50" class="navbar-custom-logo d-inline-block align-center" alt="" loading="lazy">
                </span>
            NetKet</a>
      <span class="navbar-text navbar-version pull-left"><b></b></span>

      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
          <!-- Active class kept here for posterity
          <li class="nav-item active">
            <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
          </li>
          -->
          
              <li class="nav-item">
                <a class="nav-link" href="../getting_started.html">Get Started</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../citing.html">Citing NetKet</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../about.html">About</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../index.html">Documentation</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../api/api.html">API Reference</a>
              </li>
          
        </ul>
        <ul class="navbar-nav ml-auto">
          
              <li class="nav-item">
                <a class="nav-link" href="https://github.com/netket/netket"><i class="fab fa-github" aria-hidden="true"></i></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="https://twitter.com/NetKetOrg"><i class="fab fa-twitter" aria-hidden="true"></i></a>
              </li>
          
          
            <li class="nav-item">
              <a class="btn btn-outline-warning btn-download" href="../docs2/install.html">Install</a>
            </li>
          
        </ul>
      </div>
    </div>
  </nav>
<!-- /end NAVBAR From boostrap 4.5 and old netket --></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="pl-4 pr-3 bd-sidebar site-navigation noprint " id="site-navigation">
    <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo_simple.jpg" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../docs2/install.html">
   Installation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="j1j2.html">
   Ground-State: J1-J2 model
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Symmetries: Honeycomb Heisenberg model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference Documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/changelog.html">
   Change Log
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/superop.html">
   The Lindblad Master Equation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/hilbert.html">
   The Hilbert module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/operator.html">
   The Operator module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/varstate.html">
   The Variational State Interface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/sr.html">
   Quantum Geometric Tensor and Stochastic Reconfiguration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/drivers.html">
   The Drivers API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/sharp-bits.html">
   🔪 The Sharp Bits 🔪
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/api-stability.html">
   API Stability
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../api/api.html">
   Public API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/graph.html">
     netket.graph
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.AbstractGraph.html">
       netket.graph.AbstractGraph
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Graph.html">
       netket.graph.Graph
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Lattice.html">
       netket.graph.Lattice
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Edgeless.html">
       netket.graph.Edgeless
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Hypercube.html">
       netket.graph.Hypercube
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.lattice.LatticeSite.html">
       netket.graph.lattice.LatticeSite
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Grid.html">
       netket.graph.Grid
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Diamond.html">
       netket.graph.Diamond
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Kagome.html">
       netket.graph.Kagome
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Square.html">
       netket.graph.Square
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Chain.html">
       netket.graph.Chain
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Cube.html">
       netket.graph.Cube
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.BCC.html">
       netket.graph.BCC
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.FCC.html">
       netket.graph.FCC
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Honeycomb.html">
       netket.graph.Honeycomb
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.KitaevHoneycomb.html">
       netket.graph.KitaevHoneycomb
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Triangular.html">
       netket.graph.Triangular
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Pyrochlore.html">
       netket.graph.Pyrochlore
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.DoubledGraph.html">
       netket.graph.DoubledGraph
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.disjoint_union.html">
       netket.graph.disjoint_union
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/hilbert.html">
     netket.hilbert
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.AbstractHilbert.html">
       netket.hilbert.AbstractHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.ContinuousHilbert.html">
       netket.hilbert.ContinuousHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.DiscreteHilbert.html">
       netket.hilbert.DiscreteHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.HomogeneousHilbert.html">
       netket.hilbert.HomogeneousHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.CustomHilbert.html">
       netket.hilbert.CustomHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.TensorHilbert.html">
       netket.hilbert.TensorHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.DoubledHilbert.html">
       netket.hilbert.DoubledHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.Spin.html">
       netket.hilbert.Spin
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.Qubit.html">
       netket.hilbert.Qubit
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.Fock.html">
       netket.hilbert.Fock
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.Particle.html">
       netket.hilbert.Particle
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/operator.html">
     netket.operator
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.AbstractOperator.html">
       netket.operator.AbstractOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.AbstractSuperOperator.html">
       netket.operator.AbstractSuperOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.DiscreteOperator.html">
       netket.operator.DiscreteOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.BoseHubbard.html">
       netket.operator.BoseHubbard
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.GraphOperator.html">
       netket.operator.GraphOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.LocalOperator.html">
       netket.operator.LocalOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.Ising.html">
       netket.operator.Ising
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.Heisenberg.html">
       netket.operator.Heisenberg
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.PauliStrings.html">
       netket.operator.PauliStrings
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.LocalLiouvillian.html">
       netket.operator.LocalLiouvillian
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.boson.create.html">
       netket.operator.boson.create
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.boson.destroy.html">
       netket.operator.boson.destroy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.boson.number.html">
       netket.operator.boson.number
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.boson.proj.html">
       netket.operator.boson.proj
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmax.html">
       netket.operator.spin.sigmax
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmay.html">
       netket.operator.spin.sigmay
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmaz.html">
       netket.operator.spin.sigmaz
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmap.html">
       netket.operator.spin.sigmap
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmam.html">
       netket.operator.spin.sigmam
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.ContinuousOperator.html">
       netket.operator.ContinuousOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.KineticEnergy.html">
       netket.operator.KineticEnergy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.PotentialEnergy.html">
       netket.operator.PotentialEnergy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.SumOperator.html">
       netket.operator.SumOperator
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/exact.html">
     netket.exact
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/exact/netket.exact.full_ed.html">
       netket.exact.full_ed
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/exact/netket.exact.lanczos_ed.html">
       netket.exact.lanczos_ed
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/exact/netket.exact.steady_state.html">
       netket.exact.steady_state
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/sampler.html">
     netket.sampler
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.Sampler.html">
       netket.sampler.Sampler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.SamplerState.html">
       netket.sampler.SamplerState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisSamplerState.html">
       netket.sampler.MetropolisSamplerState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisRule.html">
       netket.sampler.MetropolisRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.ExactSampler.html">
       netket.sampler.ExactSampler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisSampler.html">
       netket.sampler.MetropolisSampler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisSamplerNumpy.html">
       netket.sampler.MetropolisSamplerNumpy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.ARDirectSampler.html">
       netket.sampler.ARDirectSampler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisLocal.html">
       netket.sampler.MetropolisLocal
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisExchange.html">
       netket.sampler.MetropolisExchange
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisHamiltonian.html">
       netket.sampler.MetropolisHamiltonian
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisRule.html">
       netket.sampler.MetropolisRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.LocalRule.html">
       netket.sampler.rules.LocalRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.ExchangeRule.html">
       netket.sampler.rules.ExchangeRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.HamiltonianRule.html">
       netket.sampler.rules.HamiltonianRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.HamiltonianRuleNumpy.html">
       netket.sampler.rules.HamiltonianRuleNumpy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.CustomRuleNumpy.html">
       netket.sampler.rules.CustomRuleNumpy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.SamplerState.html">
       netket.sampler.SamplerState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisSamplerState.html">
       netket.sampler.MetropolisSamplerState
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/models.html">
     netket.models
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.RBM.html">
       netket.models.RBM
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.RBMModPhase.html">
       netket.models.RBMModPhase
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.RBMMultiVal.html">
       netket.models.RBMMultiVal
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.RBMSymm.html">
       netket.models.RBMSymm
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.Jastrow.html">
       netket.models.Jastrow
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.MPSPeriodic.html">
       netket.models.MPSPeriodic
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.NDM.html">
       netket.models.NDM
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.GCNN.html">
       netket.models.GCNN
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.AbstractARNN.html">
       netket.models.AbstractARNN
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.ARNNDense.html">
       netket.models.ARNNDense
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.ARNNConv1D.html">
       netket.models.ARNNConv1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.ARNNConv2D.html">
       netket.models.ARNNConv2D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.FastARNNConv1D.html">
       netket.models.FastARNNConv1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.FastARNNConv2D.html">
       netket.models.FastARNNConv2D
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/nn.html">
     netket.nn
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.Dense.html">
       netket.nn.Dense
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.DenseGeneral.html">
       netket.nn.DenseGeneral
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.DenseSymm.html">
       netket.nn.DenseSymm
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.DenseEquivariant.html">
       netket.nn.DenseEquivariant
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.Conv.html">
       netket.nn.Conv
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.Embed.html">
       netket.nn.Embed
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.MaskedDense1D.html">
       netket.nn.MaskedDense1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.MaskedConv1D.html">
       netket.nn.MaskedConv1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.MaskedConv2D.html">
       netket.nn.MaskedConv2D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.celu.html">
       netket.nn.celu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.elu.html">
       netket.nn.elu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.gelu.html">
       netket.nn.gelu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.glu.html">
       netket.nn.glu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.log_sigmoid.html">
       netket.nn.log_sigmoid
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.log_softmax.html">
       netket.nn.log_softmax
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.relu.html">
       netket.nn.relu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.sigmoid.html">
       netket.nn.sigmoid
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.soft_sign.html">
       netket.nn.soft_sign
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.softmax.html">
       netket.nn.softmax
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.softplus.html">
       netket.nn.softplus
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.swish.html">
       netket.nn.swish
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.log_cosh.html">
       netket.nn.log_cosh
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.reim_relu.html">
       netket.nn.reim_relu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.reim_selu.html">
       netket.nn.reim_selu
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/jax.html">
     netket.jax
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.HashablePartial.html">
       netket.jax.HashablePartial
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.PRNGKey.html">
       netket.jax.PRNGKey
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.PRNGSeq.html">
       netket.jax.PRNGSeq
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.mpi_split.html">
       netket.jax.mpi_split
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_dot.html">
       netket.jax.tree_dot
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_axpy.html">
       netket.jax.tree_axpy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_cast.html">
       netket.jax.tree_cast
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_conj.html">
       netket.jax.tree_conj
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_size.html">
       netket.jax.tree_size
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_leaf_iscomplex.html">
       netket.jax.tree_leaf_iscomplex
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_ishomogeneous.html">
       netket.jax.tree_ishomogeneous
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_ravel.html">
       netket.jax.tree_ravel
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_to_real.html">
       netket.jax.tree_to_real
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.dtype_complex.html">
       netket.jax.dtype_complex
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.is_complex.html">
       netket.jax.is_complex
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.is_complex_dtype.html">
       netket.jax.is_complex_dtype
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.maybe_promote_to_complex.html">
       netket.jax.maybe_promote_to_complex
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.expect.html">
       netket.jax.expect
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.vjp.html">
       netket.jax.vjp
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.chunk.html">
       netket.jax.chunk
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.unchunk.html">
       netket.jax.unchunk
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.vjp_chunked.html">
       netket.jax.vjp_chunked
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.vmap_chunked.html">
       netket.jax.vmap_chunked
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/vqs.html">
     netket.vqs
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.VariationalState.html">
       netket.vqs.VariationalState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.ExactState.html">
       netket.vqs.ExactState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCState.html">
       netket.vqs.MCState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCMixedState.html">
       netket.vqs.MCMixedState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.get_local_kernel.html">
       netket.vqs.get_local_kernel
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.get_local_kernel_arguments.html">
       netket.vqs.get_local_kernel_arguments
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/optimizer.html">
     netket.optimizer
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.Adam.html">
       netket.optimizer.Adam
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.AdaGrad.html">
       netket.optimizer.AdaGrad
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.Sgd.html">
       netket.optimizer.Sgd
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.Momentum.html">
       netket.optimizer.Momentum
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.RmsProp.html">
       netket.optimizer.RmsProp
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.SR.html">
       netket.optimizer.SR
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.qgt.QGTAuto.html">
       netket.optimizer.qgt.QGTAuto
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.qgt.QGTOnTheFly.html">
       netket.optimizer.qgt.QGTOnTheFly
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.qgt.QGTJacobianPyTree.html">
       netket.optimizer.qgt.QGTJacobianPyTree
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.qgt.QGTJacobianDense.html">
       netket.optimizer.qgt.QGTJacobianDense
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.solver.svd.html">
       netket.optimizer.solver.svd
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.solver.cholesky.html">
       netket.optimizer.solver.cholesky
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.solver.LU.html">
       netket.optimizer.solver.LU
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.solver.solve.html">
       netket.optimizer.solver.solve
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/logging.html">
     netket.logging
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/driver/netket.logging.RuntimeLog.html">
       netket.logging.RuntimeLog
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/driver/netket.logging.JsonLog.html">
       netket.logging.JsonLog
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/driver/netket.logging.StateLog.html">
       netket.logging.StateLog
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/driver/netket.logging.TensorBoardLog.html">
       netket.logging.TensorBoardLog
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/callbacks.html">
     netket.callbacks
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
    <label for="toctree-checkbox-13">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/callbacks/netket.callbacks.EarlyStopping.html">
       netket.callbacks.EarlyStopping
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/callbacks/netket.callbacks.Timeout.html">
       netket.callbacks.Timeout
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/utils.html">
     netket.utils
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.HashableArray.html">
       netket.utils.HashableArray
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.available.html">
       netket.utils.mpi.available
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.n_nodes.html">
       netket.utils.mpi.n_nodes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.rank.html">
       netket.utils.mpi.rank
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.MPI_jax_comm.html">
       netket.utils.mpi.MPI_jax_comm
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.MPI_py_comm.html">
       netket.utils.mpi.MPI_py_comm
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../docs/api-experimental.html">
   Experimental API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/samplers/netket.experimental.sampler.MetropolisPtSampler.html">
     netket.experimental.sampler.MetropolisPtSampler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/samplers/netket.experimental.sampler.MetropolisLocalPt.html">
     netket.experimental.sampler.MetropolisLocalPt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/samplers/netket.experimental.sampler.MetropolisExchangePt.html">
     netket.experimental.sampler.MetropolisExchangePt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/samplers/netket.experimental.sampler.MetropolisSamplerPmap.html">
     netket.experimental.sampler.MetropolisSamplerPmap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/variational/netket.experimental.vqs.variables_from_file.html">
     netket.experimental.vqs.variables_from_file
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/variational/netket.experimental.vqs.variables_from_tar.html">
     netket.experimental.vqs.variables_from_tar
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/dynamics/netket.experimental.driver.TDVP.html">
     netket.experimental.driver.TDVP
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Developer Documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/contributing.html">
   Contributing to NetKet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/writing-tests.html">
   Writing Tests
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        


<div class="col py-1 d-flex topbar-main">
    <div class="topbar-left">
        
        <label class="nav-toggle-button topbarbtn" for="__navigation">
            <div class="visually-hidden">Toggle navigation</div>
            <i class="fas fa-bars"></i>
        </label>
        
    </div>
    <div class="topbar-right">
        <!-- Launch buttons -->


<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/netket/netket/blob/master/tutorials/G-CNN_Honeycomb.ipynb">
    <button type="button"
        class="topbarbtn--wide"
        title="Launch on Colab"
        data-toggle="tooltip"
        data-placement="left">
    <img class="colab-button-logo"
        src="../_static/images/logo_colab.png"
        alt="Launch on Colab">
        Colab
    </button>
</a>
        
        
        
    </div>
</div>

        <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/netket/netket"><button type="button" class="topbarbtn--wide"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/netket/netket/issues/new?title=Issue%20on%20page%20%2Ftutorials/G-CNN_Honeycomb.html&body=Your%20issue%20content%20here."><button
                type="button" class="topbarbtn--wide" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

        
<div class="dropdown-buttons-trigger sb-download-buttons">
    <button id="dropdown-buttons-trigger" class="topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/tutorials/G-CNN_Honeycomb.ipynb.txt"><button type="button"
                class="topbarbtn--wide" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="topbarbtn--wide" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <label class="d-block d-md-none nav-toggle-button topbarbtn" for="__page-toc">
  <div class="visually-hidden">Toggle Table of Contents</div>
  <i class="fas fa-list"></i>
</label>
    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#g-cnns-are-generalizations-of-cnns-to-non-abelian-groups">
   G-CNNs are generalizations of CNNs to non-abelian groups
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defining-the-hamiltonian">
   Defining the Hamiltonian
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defining-the-gcnn">
   Defining the GCNN
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#variational-monte-carlo">
   Variational Monte Carlo
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#checking-with-ed">
   Checking with ED
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulating-a-larger-lattice">
   Simulating A Larger Lattice
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Symmetries: Honeycomb Heisenberg model</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#g-cnns-are-generalizations-of-cnns-to-non-abelian-groups">
   G-CNNs are generalizations of CNNs to non-abelian groups
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defining-the-hamiltonian">
   Defining the Hamiltonian
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defining-the-gcnn">
   Defining the GCNN
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#variational-monte-carlo">
   Variational Monte Carlo
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#checking-with-ed">
   Checking with ED
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulating-a-larger-lattice">
   Simulating A Larger Lattice
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="symmetries-honeycomb-heisenberg-model">
<h1>Symmetries: Honeycomb Heisenberg model<a class="headerlink" href="#symmetries-honeycomb-heisenberg-model" title="Permalink to this headline">¶</a></h1>
<p>The goal of this tutorial is to learn about group convolutional neural networks (G-CNNs), a useful tool for simulating lattices with high symmetry.
The G-CNN is a generalization to the convolutional neural network (CNN) to non-abelian symmetry groups (groups that contain at least one pair of non-commuting elements).
G-CNNs are a natural fit for lattices that have both point group and translational symmetries, as rotations, reflections and translations don’t commute with one-another.
G-CNN can be uesd to study both the ground-state and excited-states.</p>
<p>In this tutorial we will learn the ground state of the antiferromagnetic Heisenberg model on  the honeycomb lattice. The Heisenberg Hamiltonian is defined as follows:</p>
<div class="math notranslate nohighlight">
\[ H = \sum_{i,j \in \langle \rangle} \vec{\sigma}_{i} \cdot \vec{\sigma}_{j},\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{\sigma}_{i}\)</span> are Pauli matrices and <span class="math notranslate nohighlight">\(&lt;&gt;\)</span> denotes nearest neighbor interactons.</p>
<p>For this tutorial, many of the calculations will be much faster on a GPU.
If you don’t have access to a GPU, you can open a <a class="reference external" href="https://colab.research.google.com/">Google Colab</a> notebook, and set runtime type to GPU.
To launch this notebook on Colab simply press the rocket button on the top bar.</p>
<p>This tutorial wil be split into two parts:</p>
<ul class="simple">
<li><p>First I’ll provide a brief introduction to G-CNNs and describe what advantages they bring.</p></li>
<li><p>Second, we’ll use NetKet to find the ground state of the antiferromagnetic Heisenberg model on the honeycomb lattice. First we will simulate a lattice with <span class="math notranslate nohighlight">\(N=18\)</span> sites in order to compare with exact diagonalization. Then we will simulate a lattice with <span class="math notranslate nohighlight">\(N=72\)</span> sites.</p></li>
</ul>
<section id="g-cnns-are-generalizations-of-cnns-to-non-abelian-groups">
<h2>G-CNNs are generalizations of CNNs to non-abelian groups<a class="headerlink" href="#g-cnns-are-generalizations-of-cnns-to-non-abelian-groups" title="Permalink to this headline">¶</a></h2>
<p>The convolutional neural network (CNN) has revolutionized the field of computer vision. The CNN enforces translational invariance, which means that feeding a CNN translated copies of an image will produce the exact same output. This is important for recognizing objects, which may located differently in different images.</p>
<p>The  hidden layers of a CNN contain a group of <span class="math notranslate nohighlight">\({\bf features}\)</span>, corresponding to translations of the image, where each feature is represented by a vector. At each layer, the CNN integrates over these features to produce a different set of features over the translation group:</p>
<div class="math notranslate nohighlight">
\[ C^i_{x,y} = \sum_h {\bf W}_{x'-x, y'-y} \cdot {\bf f}_{x,y} \]</div>
<p>As you can see, the index of the filter W is based on the displacement between the input feature {x’,y’} and the output feature {x, y}. This is known as an equivariant operation, as displacements in the input are propagated as displacements in the output (equivariance is actually bit more general, we’ll get to that in a moment). In the last layer, the CNN averages over these different features, forcing the output to be invariant to the input.</p>
<p>To generalize the CNN to the G-CNN, lets abstract away from the specifics of the convolution. Instead of indexing the features with translations, we will use elements from a general symmetry group which may contain non-commmuting operations. In this case we must define a particular order of operations. For example, we could define an operation in the <span class="math notranslate nohighlight">\(p6m\)</span> space group, as a translation, followed by a rotation and a reflection about the origin. Non-abelian groups still maintain associativity and a closed algebra. This is easy to see with lattice symmetry groups. If two successive symmetry operations leave the lattice unchanged, applying both must also leave the lattice unchanged and therefore be symmetry operation in the group.</p>
<p>For G-convolutions, the building blocks of the G-CNN, this algebra is all we need. The G-convolution also indexes the filters by looking at the “difference” between group elements, however this time there is an orientation to it. The G-convolution is defined as follows:</p>
<div class="math notranslate nohighlight">
\[ C^i_g = \sum_h {\bf W}_{g^{-1} h} \cdot {\bf f}_h \]</div>
<p>The filters are indexed by <span class="math notranslate nohighlight">\(g^{-1} h\)</span>, which describes the mapping from <span class="math notranslate nohighlight">\(g \rightarrow h\)</span> but not vice-versa. This causes the output to be an <span class="math notranslate nohighlight">\({\bf involution}\)</span> of the input, meaning that the group elements are mapped to their respective inverses.</p>
<p>G-convolutions are the most expressive linear transformation over a particular symmetry group. Therefore, if you want to define a linear-based model with a particular symmetry, G-CNNs maximize the number of parameters you can fit into a given memory profile. G-CNNs can be mapped down to other symmetry-averaged multi-layer linear models by masking filters (setting them to zero). On the Honeycomb lattice, the G-CNN (approximately) has a factor of 12 more parameters than a CNN averaged over <span class="math notranslate nohighlight">\(d_6\)</span> and a factor of <span class="math notranslate nohighlight">\(12 N\)</span> more parameters than a feedforward neural network averaged over <span class="math notranslate nohighlight">\(p6m\)</span> (where N is the number of sites) under an identical memory constraint.</p>
<p>If you’d like to learn more about G-CNNs, check out the <a class="reference external" href="http://proceedings.mlr.press/v48/cohenc16.pdf">original paper</a> by Cohen <span class="math notranslate nohighlight">\({\it et \ al.}\)</span> or <a class="reference external" href="https://arxiv.org/pdf/2104.05085.pdf">this paper</a> by Roth <span class="math notranslate nohighlight">\({\it et \ al.}\)</span> that applies G-CNNs to quantum many-body systems.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">pip</span> install --quiet netket
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">WARNING: You are using pip version 22.0.2; however, version 22.0.3 is available.</span>
<span class=" -Color -Color-Yellow">You should consider upgrading via the &#39;/home/filippovicentini/Documents/pythonenvs/utils-jupuyterlab/bin/python -m pip install --upgrade pip&#39; command.</span>
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">netket</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="c1"># Import Json, this will be needed to examine log files</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="c1"># Helper libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="defining-the-hamiltonian">
<h2>Defining the Hamiltonian<a class="headerlink" href="#defining-the-hamiltonian" title="Permalink to this headline">¶</a></h2>
<p>We begin by defining the Hamiltonian as a list of lattice points. NetKet will automatically convert these points into a graph with nearest neighbor connections. The honeycomb lattice is a triangular lattice with two sites per unit cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Basis Vectors that define the positioning of the unit cell</span>
<span class="n">basis_vectors</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">]]</span>

<span class="c1">#Locations of atoms within the unit cell</span>
<span class="n">atom_positions</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">]]</span>

<span class="c1">#Number of unit cells in each direction</span>
<span class="n">dimensions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>

<span class="c1">#Define the graph </span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Lattice</span><span class="p">(</span><span class="n">basis_vectors</span><span class="o">=</span><span class="n">basis_vectors</span><span class="p">,</span> 
                         <span class="n">atoms_coord</span> <span class="o">=</span> <span class="n">atom_positions</span><span class="p">,</span> 
                         <span class="n">extent</span> <span class="o">=</span> <span class="n">dimensions</span>
                        <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Lets check to see if our graph looks as expected. Since we have two sites per unit cell, we should have <span class="math notranslate nohighlight">\(3 \times 3 \times 2 = 18\)</span> sites. The coordination number of a hexagonal lattice is 3, so we should have <span class="math notranslate nohighlight">\(\frac{18 \times 3}{2} = 27\)</span> edges. Finally we have p6m symmetry, which should give ue <span class="math notranslate nohighlight">\(3 \times 3 \times 12 = 108\)</span> symmetry operations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Use Netket to find symmetries of the graph</span>
<span class="n">symmetries</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">automorphisms</span><span class="p">()</span>

<span class="c1">#Check that graph info is correct</span>
<span class="nb">print</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">n_nodes</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">n_edges</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">symmetries</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>18
27
216
</pre></div>
</div>
</div>
</div>
<p>Oops! It looks like we have twice as many symmetries elements as we thought. Luckily for us, the ground state is still symmetric with respect to this extra symmetry that is unique to the <span class="math notranslate nohighlight">\(3 \times 3\)</span> lattice. We use this graph to define our Hilbert space and Hamiltonian:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the Hilbert space</span>
<span class="n">hi</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">hilbert</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">graph</span><span class="o">.</span><span class="n">n_nodes</span><span class="p">,</span> <span class="n">total_sz</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1">#Define the Hamiltonian</span>
<span class="n">ha</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">operator</span><span class="o">.</span><span class="n">Heisenberg</span><span class="p">(</span><span class="n">hilbert</span><span class="o">=</span><span class="n">hi</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">,</span> <span class="n">sign_rule</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Since the Hexagonal lattice is bipartite, we know the phases obey a Marshall-Peierls sign rule. Therefore, we can use a real valued NN and just learn the amplitudes of the wavefunction.</p>
<p>For models with a more complicated phase structure, its often better to learn the phases in an equal-amplitude configuration before training the amplitudes as detailed in <a class="reference external" href="https://journals.aps.org/prresearch/pdf/10.1103/PhysRevResearch.2.033075">this paper</a>. This can be implemented by first optimizing the weights on a modified model that sets <span class="math notranslate nohighlight">\(Re[log(\psi)] = 0\)</span></p>
<p>We also optimize over states with total <span class="math notranslate nohighlight">\(S_z\)</span> of zero since we know the ground state has spin 0.</p>
</section>
<section id="defining-the-gcnn">
<h2>Defining the GCNN<a class="headerlink" href="#defining-the-gcnn" title="Permalink to this headline">¶</a></h2>
<p>We can define a GCNN with an arbitrary number of layers and specify the feature dimension of each layer accordingly:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Feature dimensions of hidden layers, from first to last</span>
<span class="n">feature_dims</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>

<span class="c1">#Number of layers</span>
<span class="n">num_layers</span> <span class="o">=</span> <span class="mi">4</span>

<span class="c1">#Define the GCNN </span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">GCNN</span><span class="p">(</span><span class="n">symmetries</span> <span class="o">=</span> <span class="n">symmetries</span><span class="p">,</span> <span class="n">layers</span> <span class="o">=</span> <span class="n">num_layers</span><span class="p">,</span> <span class="n">features</span> <span class="o">=</span> <span class="n">feature_dims</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This a G-CNN with four layers, where each hidden layer contains a feature vector of length 8 for each element in p6m. This means that each hidden state has <span class="math notranslate nohighlight">\(8 \times 192 = 768\)</span> nodes. This is a huge model! But since we’re not symmetry-averaging, we only need to compute one wavefunction for each <span class="math notranslate nohighlight">\({\bf \sigma}\)</span>.</p>
<p>Feel free to try different shaped models. By default, the GCNN weights are initialized with variance scaling, which ensures that the activations will be unit-normal throughout the model at the start of training. Additionally, GCNN defaults to a SELU non-linearity, which moves the activations in the direction of unit-normal, even when they start to deviate. These features ensure that our model will behave well, even when we stack a large number of layers.</p>
</section>
<section id="variational-monte-carlo">
<h2>Variational Monte Carlo<a class="headerlink" href="#variational-monte-carlo" title="Permalink to this headline">¶</a></h2>
<p>In order to perform VMC we need to define a sampler and an optimizer. We sample using Metropolis-Hastings, which uses the exchange rule to propose new states. The exchange rule swaps the spin of two neighbouring sites, keeping the magnetization fixed (in this case, 0). We optimize uzing stochaistic reconfiguration, which uses curvature information to find the best direction of descent.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Metropois-Hastings with two spins flipped that are at most second nearest neighbors </span>
<span class="n">sa</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">MetropolisExchange</span><span class="p">(</span><span class="n">hilbert</span> <span class="o">=</span> <span class="n">hi</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">,</span> <span class="n">d_max</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1">#Stochaistic reconfiguration   </span>
<span class="n">op</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">Sgd</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
<span class="n">sr</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="n">diag_shift</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="c1">#Define a variational state so we can keep the parameters if we like</span>
<span class="n">vstate</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">variational</span><span class="o">.</span><span class="n">MCState</span><span class="p">(</span><span class="n">sampler</span><span class="o">=</span><span class="n">sa</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1">#Define a driver that performs VMC</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">VMC</span><span class="p">(</span><span class="n">ha</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">variational_state</span><span class="o">=</span><span class="n">vstate</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Lets start by running for 100 iterations. This took about 15 seconds per iteration on my CPU and about 1 second per iteration on the Tesla P100 GPU (If you’re using the free version of Colab you may get a Tesla K80 which is slightly slower). GPUs are fast! As you’ll see later, the speedup is even more pronounced on larger lattices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Run the optimization</span>
<span class="n">gs</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">n_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 100/100 [01:06&lt;00:00,  1.51it/s, Energy=-40.471 ± 0.046 [σ²=0.238, R̂=0.9744]]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;netket.logging.json_log.JsonLog at 0x7fea898371d0&gt;,)
</pre></div>
</div>
</div>
</div>
<p>This should get us under 0.1% error. Lets see how the energy evolves as we train.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Get data from log and </span>
<span class="n">energy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;out.log&quot;</span><span class="p">))</span>
<span class="k">for</span> <span class="n">en</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">][</span><span class="s2">&quot;Mean&quot;</span><span class="p">]:</span>
    <span class="n">energy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">en</span><span class="p">)</span>
    
<span class="c1">#plot the energy during the optimization</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Iterations&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Energy&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fe6a2426510&gt;]
</pre></div>
</div>
<img alt="../_images/G-CNN_Honeycomb_18_1.png" src="../_images/G-CNN_Honeycomb_18_1.png" />
</div>
</div>
<p>Looks like the first 40 iterations did most of the work! In order to get a more precise estimate, we can run 100 more iterations with a larger batch size. This will take about 15 minutes on the GPU (If you’re using a CPU, I suggest you skip this section). We access the batch size via the variational state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Change batch size</span>
<span class="n">vstate</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1">#Driver uses new batch size</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">VMC</span><span class="p">(</span><span class="n">ha</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">variational_state</span><span class="o">=</span><span class="n">vstate</span><span class="p">)</span>

<span class="c1">#Run for 100 more iterations</span>
<span class="n">gs</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">n_iter</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span><span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;out&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 100/100 [10:43&lt;00:00,  6.43s/it, Energy=-40.3884 ± 0.0045 [σ²=0.0207, R̂=1.0033]]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;netket.logging.json_log.JsonLog at 0x7fe6a31f2d90&gt;,)
</pre></div>
</div>
</div>
</div>
<p>You will notice that the variance continues to get even smaller, giving evidence that we are nearing an eigenstate.</p>
</section>
<section id="checking-with-ed">
<h2>Checking with ED<a class="headerlink" href="#checking-with-ed" title="Permalink to this headline">¶</a></h2>
<p>It seems likely that our ground state is correct, as we approached an eigenstate with low energy, but lets be safe and check our work. We can do Lanczos diagonalization for small lattices in NetKet.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Exact Diagonalization</span>
<span class="n">E_gs</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">exact</span><span class="o">.</span><span class="n">lanczos_ed</span><span class="p">(</span><span class="n">ha</span><span class="p">,</span> <span class="n">compute_eigenvectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Lets compare the VMC energy with the ED energy, by taking average energy over the last <span class="math notranslate nohighlight">\(20\)</span> iterations</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Get data from larger batch size</span>
<span class="n">energy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;out.log&quot;</span><span class="p">))</span>
<span class="k">for</span> <span class="n">en</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">][</span><span class="s2">&quot;Mean&quot;</span><span class="p">]:</span>
    <span class="n">energy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">en</span><span class="p">)</span>

<span class="n">vmc_energy_18sites</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">energy</span><span class="p">)[</span><span class="o">-</span><span class="mi">20</span><span class="p">:])</span><span class="o">/</span><span class="mi">18</span>

<span class="n">ED_energy_18sites</span> <span class="o">=</span> <span class="n">E_gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">18</span>

<span class="nb">print</span><span class="p">(</span><span class="n">vmc_energy_18sites</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ED_energy_18sites</span><span class="p">)</span>
<span class="nb">print</span><span class="p">((</span><span class="n">ED_energy_18sites</span><span class="o">-</span> <span class="n">vmc_energy_18sites</span><span class="p">)</span><span class="o">/</span><span class="n">ED_energy_18sites</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.2437762156893766
-2.243814630334411
1.7120240021148795e-05
</pre></div>
</div>
</div>
</div>
<p>Looks like our model did a good job! If you just trained for the first 100 iterations the error should be less than <span class="math notranslate nohighlight">\(10^{-4}\)</span> and if you trained with the larger batch size, the error should be close to <span class="math notranslate nohighlight">\(10^{-5}\)</span></p>
</section>
<section id="simulating-a-larger-lattice">
<h2>Simulating A Larger Lattice<a class="headerlink" href="#simulating-a-larger-lattice" title="Permalink to this headline">¶</a></h2>
<p>Lets see how the GCNN does on a larger lattice that cannot be simulated with exact diagonalization. We’ll do a <span class="math notranslate nohighlight">\(6 \times 6\)</span> lattice which has <span class="math notranslate nohighlight">\(72\)</span> sites. We need to redefine a few things:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Redefine bigger graph</span>
<span class="n">dimensions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>

<span class="c1">#Define the graph </span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Lattice</span><span class="p">(</span><span class="n">basis_vectors</span><span class="o">=</span><span class="n">basis_vectors</span><span class="p">,</span> 
                         <span class="n">atoms_coord</span> <span class="o">=</span> <span class="n">atom_positions</span><span class="p">,</span> 
                         <span class="n">extent</span> <span class="o">=</span> <span class="n">dimensions</span>
                        <span class="p">)</span>
<span class="c1"># Redefine the Hilbert/Hamiltonian for larger lattice space</span>
<span class="n">hi</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">hilbert</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">graph</span><span class="o">.</span><span class="n">n_nodes</span><span class="p">,</span> <span class="n">total_sz</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ha</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">operator</span><span class="o">.</span><span class="n">Heisenberg</span><span class="p">(</span><span class="n">hilbert</span><span class="o">=</span><span class="n">hi</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">,</span> <span class="n">sign_rule</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Compute the symmetries for the bigger graph </span>
<span class="n">symmetries</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">automorphisms</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">symmetries</span><span class="p">))</span>

<span class="c1">#Redefine everything on bigger graph</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">GCNN</span><span class="p">(</span><span class="n">symmetries</span> <span class="o">=</span> <span class="n">symmetries</span><span class="p">,</span> <span class="n">layers</span> <span class="o">=</span> <span class="n">num_layers</span><span class="p">,</span> <span class="n">features</span> <span class="o">=</span> <span class="n">feature_dims</span><span class="p">)</span>
<span class="n">sa</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">MetropolisExchange</span><span class="p">(</span><span class="n">hilbert</span> <span class="o">=</span> <span class="n">hi</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">,</span> <span class="n">d_max</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">vstate</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">variational</span><span class="o">.</span><span class="n">MCState</span><span class="p">(</span><span class="n">sampler</span><span class="o">=</span><span class="n">sa</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">ma</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_discard_per_chain</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">VMC</span><span class="p">(</span><span class="n">ha</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span> <span class="n">variational_state</span><span class="o">=</span><span class="n">vstate</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>432
</pre></div>
</div>
</div>
</div>
<p>Looks like we have no extra symmetries this time, since <span class="math notranslate nohighlight">\(6 \times 6 \times 12 = 432\)</span>. Let’s run this model for 100 iterations. You will see that we quickly get close  to the ground state. This takes 15 minutes on a P100 GPU</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">energy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">variance</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">gs</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">n_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">out</span><span class="o">=</span><span class="s2">&quot;out&quot;</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;out.log&quot;</span><span class="p">))</span>

<span class="k">for</span> <span class="n">en</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">][</span><span class="s2">&quot;Mean&quot;</span><span class="p">]:</span>
    <span class="n">energy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">en</span><span class="p">)</span>
<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">][</span><span class="s2">&quot;Variance&quot;</span><span class="p">]:</span>
    <span class="n">variance</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 100/100 [14:53&lt;00:00,  8.93s/it, Energy=-155.43 ± 0.53 [σ²=31.79, R̂=0.9946]]
</pre></div>
</div>
</div>
</div>
<p>We can plot the energy and variance to see if we’re approaching an eigenstate</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Iterations&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Energy&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f20e9c2b190&gt;]
</pre></div>
</div>
<img alt="../_images/G-CNN_Honeycomb_32_1.png" src="../_images/G-CNN_Honeycomb_32_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Iterations&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Variance&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">variance</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f20e9702e90&gt;]
</pre></div>
</div>
<img alt="../_images/G-CNN_Honeycomb_33_1.png" src="../_images/G-CNN_Honeycomb_33_1.png" />
</div>
</div>
<p>It seems we are near an eigenstate. We can do a back-of-the-envelope calculation to see if this is a realistic ground state energy</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ED_energy_18sites</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">energy</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">graph</span><span class="o">.</span><span class="n">n_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.243814630334411
-2.158805247393738
</pre></div>
</div>
</div>
</div>
<p>The energy for the bigger lattice is slightly less negative (as is typical for Heisenberg models with PBC) but they are pretty similar. It’s clear we are approaching the ground state</p>
<p>We will benchmark how well our model is perfoming by tracking the relationship between the mean and variance of the energy over 400 more iterations. Then we will extrapolate this relationship to estimate the true ground state energy. This can tell us how our error evolves over time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">intervals</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">en_estimates</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">var_estimates</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">interval</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">intervals</span><span class="p">):</span>
    <span class="c1">#run for 100 iterations</span>
    <span class="n">gs</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">n_iter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">out</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>

    <span class="c1">#load data from iterations</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;out.log&quot;</span><span class="p">))</span>

    <span class="c1">#append energies and variances to data</span>
    <span class="k">for</span> <span class="n">en</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">][</span><span class="s2">&quot;Mean&quot;</span><span class="p">]:</span>
        <span class="n">energy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">en</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">][</span><span class="s2">&quot;Variance&quot;</span><span class="p">]:</span>
        <span class="n">variance</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>

    <span class="n">en_est</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">energy</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">:])</span>
    <span class="n">var_est</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">variance</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">:])</span>
    <span class="n">en_estimates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">en_est</span><span class="p">)</span>
    <span class="n">var_estimates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var_est</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">en_est</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">var_est</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 20/20 [02:56&lt;00:00,  8.81s/it, Energy=-157.22 ± 0.32 [σ²=11.34, R̂=0.9780]]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-156.9362404126101
10.740704288189896
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<p>Lets plot the energy vs. variance and draw a line of best fit</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Variance&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Energy&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">var_estimates</span><span class="p">,</span><span class="n">en_estimates</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">var_estimates</span><span class="p">,</span><span class="n">en_estimates</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">var_estimates</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">fit</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">fit</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">fit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f20e4704410&gt;]
</pre></div>
</div>
<img alt="../_images/G-CNN_Honeycomb_40_1.png" src="../_images/G-CNN_Honeycomb_40_1.png" />
</div>
</div>
<p>You can see that that the relationship between energy and variance is fairly well captured by a quadratic function. We can use this extrapolation to estimate the true ground state energy and the error in our wavefunction. Lets estimate the final energy of our Ansatz using our last 10,000 samples</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_en</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">en_estimates</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:])</span>
<span class="n">extrapolated_est</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="nb">print</span><span class="p">((</span><span class="n">extrapolated_est</span><span class="o">-</span><span class="n">final_en</span><span class="p">)</span><span class="o">/</span><span class="n">extrapolated_est</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0012942848437390558
</pre></div>
</div>
</div>
</div>
<p>If everything went well your error should be around .1%!</p>
<p>This concludes the tutorial. Only an hour ago we knew nothing about the Heisenberg model on a Hexagonal lattice. Now we have an accurate approximation of the ground state wavefunction!</p>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="j1j2.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Ground-State: J1-J2 model</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../docs/changelog.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Change Log</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Giuseppe Carleo et al.<br/>
  
      &copy; Copyright 2019-2021, The Netket authors - All rights reserved.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  
  <script src="../_static/scripts/sphinx-book-theme.js?digest=da817022793a90a681ee"></script>


  </body>
</html>