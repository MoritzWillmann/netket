<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Operator module &mdash; netket v3.0 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The Variational State Interface" href="varstate.html" />
    <link rel="prev" title="The Hilbert module" href="hilbert.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> netket<img src="../_static/logonav.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/netket3.html">Ground-State Variational Search with NetKet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/jax.html">Using JAX as a backend in NetKet - Feature Preview for v3.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/G-CNN_Honeycomb.html">Using a group convolutional neural network to learn the ground-state of a symmetric spin model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/G-CNN_Honeycomb.html#G-CNNs-are-generalizations-of-CNNs-to-non-abelian-groups">G-CNNs are generalizations of CNNs to non-abelian groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/G-CNN_Honeycomb.html#Defining-the-Hamiltonian">Defining the Hamiltonian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/G-CNN_Honeycomb.html#Defining-the-GCNN">Defining the GCNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/G-CNN_Honeycomb.html#Variational-Monte-Carlo">Variational Monte Carlo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/G-CNN_Honeycomb.html#Checking-with-ED">Checking with ED</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/G-CNN_Honeycomb.html#Simulating-A-Larger-Lattice">Simulating A Larger Lattice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/j1j2.html">Variational Monte Carlo with Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/Heisenberg1d.html">Learning the ground-state of a spin model with different Neural Networks available in NetKet</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="superop.html">The Lindblad Master Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="hilbert.html">The Hilbert module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The Operator module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-discreteoperator-interface">The DiscreteOperator interface</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="varstate.html">The Variational State Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="sr.html">Quantum Geometric Tensor and Stochastic Reconfiguration</a></li>
<li class="toctree-l1"><a class="reference internal" href="drivers.html">The Drivers API</a></li>
<li class="toctree-l1"><a class="reference internal" href="sharp-bits.html">üî™ The Sharp Bits üî™</a></li>
</ul>
<p class="caption"><span class="caption-text">Extending NetKet</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="custom_models.html">Defining Custom Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_expect.html">Overriding defaults in NetKet</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_preconditioners.html">Defining Custom Preconditioners</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_operator.html">Defining Custom Operators</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to NetKet</a></li>
<li class="toctree-l1"><a class="reference internal" href="writing-tests.html">Writing Tests</a></li>
</ul>
<p class="caption"><span class="caption-text">API documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api-stability.html">API Stability</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Public API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-experimental.html">Experimental API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">netket</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>The Operator module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/docs/operator.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="the-operator-module">
<span id="operator"></span><h1>The Operator module<a class="headerlink" href="#the-operator-module" title="Permalink to this headline">ÔÉÅ</a></h1>
<p>The <span class="xref myst">Operator</span> module defines the common interfaces used to interact with quantum operators and super-operators, as well as several concrete implementations of different operators such as <span class="xref std std-ref">netket.hilbert.LocalOperator</span>, <span class="xref std std-ref">netket.hilbert.Ising</span> and others.</p>
<p>NetKet‚Äôs operators are all sub-classes of the abstract class <span class="xref std std-ref">netket.hilbert.AbstractOperator</span>, which defines a small set of API respected by all implementations.
The inheritance diagram for the class hierarchy of the Operators included with NetKet is shown below (you can click on the nodes in the graph to go to their API documentation page).
Dashed nodes represent abstract classes that cannot be instantiated, while the others are concrete and they can be instantiated.</p>
<div class="graphviz"><img src="../_images/inheritance-735193492f7d4f3fefa762a7e816cae6b0767a6b.png" alt="Inheritance diagram of netket.operator" usemap="#inheritance46cd0fa8ef" class="inheritance graphviz" /></div>
<map id="inheritance46cd0fa8ef" name="inheritance46cd0fa8ef">
<area shape="rect" id="node1" href="_generated/operator/netket.operator.AbstractOperator.html#netket.operator.AbstractOperator" target="_top" title="Abstract class for quantum Operators. This class prototypes the methods" alt="" coords="5,242,121,264"/>
<area shape="rect" id="node3" href="_generated/operator/netket.operator.DiscreteOperator.html#netket.operator.DiscreteOperator" target="_top" title="This class is the base class for operators defined on a" alt="" coords="172,112,288,134"/>
<area shape="rect" id="node8" href="_generated/operator/netket.operator.ContinuousOperator.html#netket.operator.ContinuousOperator" target="_top" title="This class is the abstract base class for operators defined on a" alt="" coords="163,349,296,371"/>
<area shape="rect" id="node14" href="_generated/operator/netket.operator.LocalLiouvillian.html#netket.operator.LocalLiouvillian" target="_top" title="LocalLiouvillian super&#45;operator, acting on the DoubledHilbert (tensor product) space" alt="" coords="530,5,637,27"/>
<area shape="rect" id="node10" href="_generated/operator/netket.operator.LocalOperator.html#netket.operator.LocalOperator" target="_top" title="A custom local operator. This is a sum of an arbitrary number of operators" alt="" coords="364,112,463,134"/>
<area shape="rect" id="node15" href="_generated/operator/netket.operator.PauliStrings.html#netket.operator.PauliStrings" target="_top" title="A Hamiltonian consisiting of the sum of products of Pauli operators." alt="" coords="370,155,456,177"/>
<area shape="rect" id="node6" href="_generated/operator/netket.operator.BoseHubbard.html#netket.operator.BoseHubbard" target="_top" title="An extended Bose Hubbard model Hamiltonian operator, containing both" alt="" coords="536,48,631,70"/>
<area shape="rect" id="node12" href="_generated/operator/netket.operator.Ising.html#netket.operator.Ising" target="_top" title="The Transverse&#45;Field Ising Hamiltonian :math:`&#45;hsum_i sigma_i^{(x)} +Jsum_{
<area shape="rect" id="node13" href="_generated/operator/netket.operator.KineticEnergy.html#netket.operator.KineticEnergy" target="_top" title="This is the kinetic energy operator (hbar = 1). The local value is given by:" alt="" coords="364,328,462,350"/>
<area shape="rect" id="node16" href="_generated/operator/netket.operator.PotentialEnergy.html#netket.operator.PotentialEnergy" target="_top" title="Returns the local potential energy defined in afun" alt="" coords="358,371,468,393"/>
<area shape="rect" id="node18" href="_generated/operator/netket.operator.SumOperator.html#netket.operator.SumOperator" target="_top" title="This class implements the action of the _expect_kernel()&#45;method of" alt="" coords="366,414,460,437"/>
<area shape="rect" id="node9" href="_generated/operator/netket.operator.GraphOperator.html#netket.operator.GraphOperator" target="_top" title="A graph&#45;based quantum operator. In its simplest terms, this is the sum of" alt="" coords="532,134,636,156"/>
<area shape="rect" id="node11" href="_generated/operator/netket.operator.Heisenberg.html#netket.operator.Heisenberg" target="_top" title="The Heisenberg hamiltonian on a lattice." alt="" coords="679,134,763,156"/>
</map><p>Similarly to Hilbert spaces, there are two large classes of operators: <span class="xref std std-ref">DiscreteOperator</span> and <span class="xref std std-ref">ContinuousOperator</span>.
Evidently the formers will only work with Discrete Hilbert spaces, while the latters will only work with continuous Hilbert spaces.</p>
<p>The main function of operators in NetKet is to define the logic and some values used to compute expectation values over a variational state.
Functions implemented by operators are either needed to compute expectation values, or are nice utilities useful to manipulate or inspect the operators but are not needed by the Monte-Carlo logic interacting with the variational states.</p>
<p>All <span class="xref std std-ref">AbstractOperator</span>s act on a well defined hilbert space that can be accessed through the <code class="xref py py-attr docutils literal notranslate"><span class="pre">hilbert</span></code> attribute.
It is also possible to check if the operator is hermitian through the boolean property <code class="xref py py-attr docutils literal notranslate"><span class="pre">is_hermitian</span></code>.
There are only two other operations defined on all operator types: it is possible to take the conjugate or conjugate-transpose of an operator by accessing the methods
<code class="xref py py-meth docutils literal notranslate"><span class="pre">conj()</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">transpose</span></code>.
Those will usually return lazy wrappers.
Finally, it is also possible to call <code class="xref py py-meth docutils literal notranslate"><span class="pre">collect()</span></code> to get rid of any possible lazy wrapper.</p>
<p>The bare-minimum requirement when defining a custom operator is to define it‚Äôs hilbert space.
Most likely you will also want to define the <code class="docutils literal notranslate"><span class="pre">expect</span></code> and/or the <code class="docutils literal notranslate"><span class="pre">expect_and_grad</span></code> method to compute the expectation value of such operator over a certain Variational State.
Contrary to more standard Pythonic code, those methods are not defined as class-functions in your custom operator class, but you have to use multiple dispatch (<span class="xref std std-ref">netket.utils.dispatch.dispatch</span>) to define those methods on a specific signature such as <code class="docutils literal notranslate"><span class="pre">expect(vstate:</span> <span class="pre">MCState,</span> <span class="pre">O:</span> <span class="pre">MyCustomOperator)</span></code>.
This is needed because the way you compute expectation values and/or gradients might not only change depending on the exact operator, but depends also on the type of variational state that you are working with.
To learn more about multiple dispatch, check <a class="reference internal" href="custom_expect.html#multiple-dispatch"><span class="std std-ref">this section</span></a></p>
<p>An explanation of how to define the <code class="docutils literal notranslate"><span class="pre">expect</span></code> method for custom operators is given in the <a class="reference internal" href="custom_operator.html#custom-operator"><span class="std std-ref">Custom Operator documentation</span></a>.</p>
<div class="section" id="the-discreteoperator-interface">
<h2>The DiscreteOperator interface<a class="headerlink" href="#the-discreteoperator-interface" title="Permalink to this headline">ÔÉÅ</a></h2>
<p>Operators defined on Discrete Spaces must implement the <span class="xref std std-ref">DiscreteOperator</span> interface if they wish to work ou</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hilbert.html" class="btn btn-neutral float-left" title="The Hilbert module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="varstate.html" class="btn btn-neutral float-right" title="The Variational State Interface" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2021, The Netket authors - All rights reserved.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 

<script type="text/javascript">
    jQuery(function () {
        SphinxRtdTheme.Navigation.enable(true);
      })
</script>

<!-- Temporary footer
<div class="footer-wip">
  <div class="footer-wip-content">
    This documentation refers to an unreleased version of Netket.
  </div>
</div>
-->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-118013987-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-118013987-1');
</script>

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "url": "https://www.netket.org",
  "name": "NetKet",
  "founder": "Giuseppe Carleo",
  "foundingDate": "2018-04-24",
  "foundingLocation" : "New York",
  "logo": "https://www.netket.org/img/logo_small.jpg",
  "sameAs": [
    "https://twitter.com/NetKetOrg",
    "https://github.com/NetKet/netket"
  ],
  "description" : "Netket is an open-source project delivering cutting-edge
  methods for the study of many-body quantum systems with artificial neural
  networks and machine learning techniques."
}
</script>


</body>
</html>