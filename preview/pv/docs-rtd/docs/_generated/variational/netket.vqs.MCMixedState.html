<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>netket.vqs.MCMixedState &mdash; netket v3.0 documentation</title><link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="netket.vqs.get_local_kernel" href="netket.vqs.get_local_kernel.html" />
    <link rel="prev" title="netket.vqs.MCState" href="netket.vqs.MCState.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> netket<img src="../../../_static/logonav.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/netket3.html">Ground-State Variational Search with NetKet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/jax.html">Using JAX as a backend in NetKet - Feature Preview for v3.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/G-CNN_Honeycomb.html">Using a group convolutional neural network to learn the ground-state of a symmetric spin model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/j1j2.html">Variational Monte Carlo with Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/Heisenberg1d.html">Learning the ground-state of a spin model with different Neural Networks available in NetKet</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../superop.html">The Lindblad Master Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hilbert.html">The Hilbert module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operator.html">The Operator module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../varstate.html">The Variational State Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sr.html">Quantum Geometric Tensor and Stochastic Reconfiguration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../drivers.html">The Drivers API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sharp-bits.html">🔪 The Sharp Bits 🔪</a></li>
</ul>
<p class="caption"><span class="caption-text">Extending NetKet</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../custom_models.html">Defining Custom Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../custom_expect.html">Overriding defaults in NetKet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../custom_preconditioners.html">Defining Custom Preconditioners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../custom_operator.html">Defining Custom Operators</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing to NetKet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../writing-tests.html">Writing Tests</a></li>
</ul>
<p class="caption"><span class="caption-text">API documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../api-stability.html">API Stability</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../api.html">Public API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../api.html#graph">Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#hilbert">Hilbert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#operators">Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#exact-solvers">Exact solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#sampler">Sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#pre-built-models">Pre-built models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#model-tools">Model tools</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../api.html#variational-state-interface">Variational State Interface</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="netket.vqs.VariationalState.html">netket.vqs.VariationalState</a></li>
<li class="toctree-l3"><a class="reference internal" href="netket.vqs.ExactState.html">netket.vqs.ExactState</a></li>
<li class="toctree-l3"><a class="reference internal" href="netket.vqs.MCState.html">netket.vqs.MCState</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">netket.vqs.MCMixedState</a></li>
<li class="toctree-l3"><a class="reference internal" href="netket.vqs.get_local_kernel.html">netket.vqs.get_local_kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="netket.vqs.get_local_kernel_arguments.html">netket.vqs.get_local_kernel_arguments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#optimizer-module">Optimizer Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#optimization-drivers">Optimization drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#logging-output">Logging output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#utils">Utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#callbacks">Callbacks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api-experimental.html">Experimental API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">netket</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../api.html">Public API</a> &raquo;</li>
      <li>netket.vqs.MCMixedState</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/docs/_generated/variational/netket.vqs.MCMixedState.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="netket-vqs-mcmixedstate">
<h1>netket.vqs.MCMixedState<a class="headerlink" href="#netket-vqs-mcmixedstate" title="Permalink to this headline"></a></h1>
<dl class="py class">
<dt id="netket.vqs.MCMixedState">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">netket.vqs.</span></code><code class="sig-name descname"><span class="pre">MCMixedState</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampler_diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples_diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples_per_rank_diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_discard_per_chain_diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_discard_diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampler_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#netket.vqs.MCMixedState" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">netket.vqs.VariationalMixedState</span></code>, <a class="reference internal" href="netket.vqs.MCState.html#netket.vqs.MCState" title="netket.vqs.MCState"><code class="xref py py-class docutils literal notranslate"><span class="pre">netket.vqs.MCState</span></code></a></p>
<p>Variational State for a Mixed Variational Neural Quantum State.</p>
<p>The state is sampled according to the provided sampler, and it’s diagonal is sampled
according to another sampler.</p>
<dl class="class-dl-groups">
<dt>Inheritance</dt><dd><div class="graphviz"><img src="../../../_images/inheritance-7a9c40b1f41eef7661b3327bc62eacc384740e4f.png" alt="Inheritance diagram of netket.vqs.MCMixedState" usemap="#inheritanceb6798e555a" class="inheritance graphviz" /></div>
<map id="inheritanceb6798e555a" name="inheritanceb6798e555a">
<area shape="rect" id="node1" href="#netket.vqs.MCMixedState" target="_top" title="Variational State for a Mixed Variational Neural Quantum State." alt="" coords="447,31,589,56"/>
<area shape="rect" id="node3" href="netket.vqs.MCState.html#netket.vqs.MCState" target="_top" title="Variational State for a Variational Neural Quantum State." alt="" coords="251,55,355,80"/>
<area shape="rect" id="node4" href="netket.vqs.VariationalState.html#netket.vqs.VariationalState" target="_top" title="Abstract class for variational states representing either pure states" alt="" coords="5,31,159,56"/>
</map></dd>
</dl>
<dl class="py method">
<dt id="netket.vqs.MCMixedState.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampler_diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples_diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples_per_rank_diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_discard_per_chain_diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_discard_diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampler_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/netket/vqs/mc/mc_mixed_state/state.html#MCMixedState.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#netket.vqs.MCMixedState.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructs the MCMixedState.
Arguments are the same as <a class="reference internal" href="netket.vqs.MCState.html#netket.vqs.MCState" title="netket.vqs.MCState"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCState</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sampler</strong> – The sampler</p></li>
<li><p><strong>model</strong> – (Optional) The model. If not provided, you must provide init_fun and apply_fun.</p></li>
<li><p><strong>n_samples</strong> – the total number of samples across chains and processes when sampling (default=1000).</p></li>
<li><p><strong>n_samples_per_rank</strong> – the total number of samples across chains on one process when sampling. Cannot be
specified together with n_samples (default=None).</p></li>
<li><p><strong>n_discard_per_chain</strong> – number of discarded samples at the beginning of each monte-carlo chain (default=n_samples/10).</p></li>
<li><p><strong>n_samples_diag</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – the total number of samples across chains and processes when sampling the diagonal
of the density matrix (default=1000).</p></li>
<li><p><strong>n_samples_per_rank_diag</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – the total number of samples across chains on one process when sampling the diagonal.
Cannot be specified together with <cite>n_samples_diag</cite> (default=None).</p></li>
<li><p><strong>n_discard_per_chain_diag</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – number of discarded samples at the beginning of each monte-carlo chain used when sampling
the diagonal of the density matrix for observables (default=n_samples_diag/10).</p></li>
<li><p><strong>parameters</strong> – Optional PyTree of weights from which to start.</p></li>
<li><p><strong>seed</strong> – rng seed used to generate a set of parameters (only if parameters is not passed). Defaults to a random one.</p></li>
<li><p><strong>sampler_seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – rng seed used to initialise the sampler. Defaults to a random one.</p></li>
<li><p><strong>mutable</strong> – Dict specifing mutable arguments. Use it to specify if the model has a state that can change
during evaluation, but that should not be optimised. See also flax.linen.module.apply documentation
(default=False)</p></li>
<li><p><strong>init_fun</strong> – Function of the signature f(model, shape, rng_key, dtype) -&gt; Optional_state, parameters used to
initialise the parameters. Defaults to the standard flax initialiser. Only specify if your network has
a non-standard init method.</p></li>
<li><p><strong>apply_fun</strong> – Function of the signature f(model, variables, σ) that should evaluate the model. Defafults to
<cite>model.apply(variables, σ)</cite>. specify only if your network has a non-standard apply method.</p></li>
<li><p><strong>training_kwargs</strong> – a dict containing the optionaal keyword arguments to be passed to the apply_fun during training.
Useful for example when you have a batchnorm layer that constructs the average/mean only during training.</p></li>
<li><p><strong>sampler_diag</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="../samplers/netket.sampler.Sampler.html#netket.sampler.Sampler" title="netket.sampler.Sampler"><em>netket.sampler.Sampler</em></a><em>]</em>) – </p></li>
<li><p><strong>n_discard_diag</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="class-dl-groups">
<dt>Attributes</dt><dd><dl class="py attribute">
<dt id="netket.vqs.MCMixedState.chain_length">
<code class="sig-name descname"><span class="pre">chain_length</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.chain_length" title="Permalink to this definition"></a></dt>
<dd><p>Length of the markov chain used for sampling configurations.</p>
<p>If running under MPI, the total samples will be n_nodes * chain_length * n_batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.chain_length_diag">
<code class="sig-name descname"><span class="pre">chain_length_diag</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.chain_length_diag" title="Permalink to this definition"></a></dt>
<dd><p>Length of the markov chain used for sampling the diagonal configurations.</p>
<p>If running under MPI, the total samples will be n_nodes * chain_length * n_batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.chunk_size">
<code class="sig-name descname"><span class="pre">chunk_size</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.chunk_size" title="Permalink to this definition"></a></dt>
<dd><p>Suggested <em>maximum size</em> of the chunks used in forward and backward evaluations
of the Neural Network model. If your inputs are smaller than the chunk size
this setting is ignored.</p>
<p>This can be used to lower the memory required to run a computation with a very
high number of samples or on a very large lattice. Notice that inputs and
outputs must still fit in memory, but the intermediate computations will now
require less memory.</p>
<p>This option comes at an increased computational cost. While this cost should
be negligible for large-enough chunk sizes, don’t use it unless you are memory
bound!</p>
<p>This option is an hint: only some operations support chunking. If you perform
an operation that is not implemented with chunking support, it will fall back
to no chunking. To check if this happened, set the environment variable
<cite>NETKET_DEBUG=1</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.diagonal">
<code class="sig-name descname"><span class="pre">diagonal</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.diagonal" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.hilbert">
<code class="sig-name descname"><span class="pre">hilbert</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.hilbert" title="Permalink to this definition"></a></dt>
<dd><p>The descriptor of the Hilbert space
on which this variational state is defined.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../hilbert/netket.hilbert.AbstractHilbert.html#netket.hilbert.AbstractHilbert" title="netket.hilbert.AbstractHilbert"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractHilbert</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.hilbert_physical">
<code class="sig-name descname"><span class="pre">hilbert_physical</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.hilbert_physical" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../hilbert/netket.hilbert.AbstractHilbert.html#netket.hilbert.AbstractHilbert" title="netket.hilbert.AbstractHilbert"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractHilbert</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.model">
<code class="sig-name descname"><span class="pre">model</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.model" title="Permalink to this definition"></a></dt>
<dd><p>Returns the model definition of this variational state.</p>
<p>This field is optional, and is set to <cite>None</cite> if the variational state has
been initialized using a custom function.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.model_state">
<code class="sig-name descname"><span class="pre">model_state</span></code><em class="property"><span class="pre">:</span> <span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#netket.vqs.MCMixedState.model_state" title="Permalink to this definition"></a></dt>
<dd><p>The optional pytree with the mutable state of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.n_discard">
<code class="sig-name descname"><span class="pre">n_discard</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.n_discard" title="Permalink to this definition"></a></dt>
<dd><p>Use <cite>n_discard_per_chain</cite> instead.</p>
<p>Number of discarded samples at the beginning of the markov chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>DEPRECATED</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.n_discard_diag">
<code class="sig-name descname"><span class="pre">n_discard_diag</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.n_discard_diag" title="Permalink to this definition"></a></dt>
<dd><p>Use <cite>n_discard_per_chain_diag</cite> instead.</p>
<p>Number of discarded samples at the beginning of the markov chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>DEPRECATED</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.n_discard_per_chain">
<code class="sig-name descname"><span class="pre">n_discard_per_chain</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.n_discard_per_chain" title="Permalink to this definition"></a></dt>
<dd><p>Number of discarded samples at the beginning of the markov chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.n_discard_per_chain_diag">
<code class="sig-name descname"><span class="pre">n_discard_per_chain_diag</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.n_discard_per_chain_diag" title="Permalink to this definition"></a></dt>
<dd><p>Number of discarded samples at the beginning of the markov chain used to
sample the diagonal of this mixed state.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.n_parameters">
<code class="sig-name descname"><span class="pre">n_parameters</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.n_parameters" title="Permalink to this definition"></a></dt>
<dd><p>The total number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.n_samples">
<code class="sig-name descname"><span class="pre">n_samples</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.n_samples" title="Permalink to this definition"></a></dt>
<dd><p>The total number of samples generated at every sampling step.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.n_samples_diag">
<code class="sig-name descname"><span class="pre">n_samples_diag</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.n_samples_diag" title="Permalink to this definition"></a></dt>
<dd><p>The total number of samples generated at every sampling step
when sampling the diagonal of this mixed state.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.n_samples_per_rank">
<code class="sig-name descname"><span class="pre">n_samples_per_rank</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.n_samples_per_rank" title="Permalink to this definition"></a></dt>
<dd><p>The number of samples generated on one MPI rank at every sampling step.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.parameters">
<code class="sig-name descname"><span class="pre">parameters</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.parameters" title="Permalink to this definition"></a></dt>
<dd><p>The pytree of the parameters of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.sampler">
<code class="sig-name descname"><span class="pre">sampler</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.sampler" title="Permalink to this definition"></a></dt>
<dd><p>The Monte Carlo sampler used by this Monte Carlo variational state.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../samplers/netket.sampler.Sampler.html#netket.sampler.Sampler" title="netket.sampler.Sampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.sampler_diag">
<code class="sig-name descname"><span class="pre">sampler_diag</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.sampler_diag" title="Permalink to this definition"></a></dt>
<dd><p>The Monte Carlo sampler used by this Monte Carlo variational state to
sample the diagonal.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../samplers/netket.sampler.Sampler.html#netket.sampler.Sampler" title="netket.sampler.Sampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.samples">
<code class="sig-name descname"><span class="pre">samples</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.samples" title="Permalink to this definition"></a></dt>
<dd><p>Returns the set of cached samples.</p>
<p>The samples returnede are guaranteed valid for the current state of
the variational state. If no cached parameters are available, then
they are sampled first and then cached.</p>
<p>To obtain a new set of samples either use <span class="xref std std-ref">reset</span> or <span class="xref std std-ref">sample</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="netket.vqs.MCMixedState.variables">
<code class="sig-name descname"><span class="pre">variables</span></code><a class="headerlink" href="#netket.vqs.MCMixedState.variables" title="Permalink to this definition"></a></dt>
<dd><p>The PyTreee containing the paramters and state of the model,
used when evaluating it.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd>
</dl>
<dl class="class-dl-groups">
<dt>Methods</dt><dd><dl class="py method">
<dt id="netket.vqs.MCMixedState.evaluate">
<code class="sig-name descname"><span class="pre">evaluate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">σ</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#netket.vqs.MCMixedState.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>DEPRECATED: use log_value instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>σ</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="netket.vqs.MCMixedState.expect">
<code class="sig-name descname"><span class="pre">expect</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ô</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#netket.vqs.MCMixedState.expect" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Estimates the quantum expectation value for a given operator O.</dt><dd><p>In the case of a pure state $psi$, this is $&lt;O&gt;= &lt;Psi|O|Psi&gt;/&lt;Psi|Psi&gt;$
otherwise for a mixed state $rho$, this is $&lt;O&gt; = Tr[rho hat{O}/Tr[rho]$.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ô</strong> – the operator O.</p></li>
<li><p><strong>Ô</strong> (<a class="reference internal" href="../operator/netket.operator.AbstractOperator.html#netket.operator.AbstractOperator" title="netket.operator.AbstractOperator"><em>netket.operator.AbstractOperator</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An estimation of the quantum expectation value &lt;O&gt;.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="netket.vqs.MCMixedState.expect_and_grad">
<code class="sig-name descname"><span class="pre">expect_and_grad</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ô</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#netket.vqs.MCMixedState.expect_and_grad" title="Permalink to this definition"></a></dt>
<dd><p>Estimates both the gradient of the quantum expectation value of a given operator O.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ô</strong> – the operator Ô for which we compute the expectation value and it’s gradient</p></li>
<li><p><strong>mutable</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – Can be bool, str, or list. Specifies which collections in the model_state should
be treated as  mutable: bool: all/no collections are mutable. str: The name of a
single mutable  collection. list: A list of names of mutable collections.
This is used to mutate the state of the model while you train it (for example
to implement BatchNorm. Consult
<a class="reference external" href="https://flax.readthedocs.io/en/latest/_modules/flax/linen/module.html#Module.apply">Flax’s Module.apply documentation</a>
for a more in-depth exaplanation).</p></li>
<li><p><strong>use_covariance</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>]) – whever to use the covariance formula, usually reserved for
hermitian operators, ⟨∂logψ Oˡᵒᶜ⟩ - ⟨∂logψ⟩⟨Oˡᵒᶜ⟩</p></li>
<li><p><strong>Ô</strong> (<a class="reference internal" href="../operator/netket.operator.AbstractOperator.html#netket.operator.AbstractOperator" title="netket.operator.AbstractOperator"><em>netket.operator.AbstractOperator</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An estimation of the quantum expectation value &lt;O&gt;.
An estimation of the average gradient of the quantum expectation value &lt;O&gt;.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="netket.vqs.MCMixedState.expect_and_grad_operator">
<code class="sig-name descname"><span class="pre">expect_and_grad_operator</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ô</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_hermitian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/netket/vqs/mc/mc_mixed_state/state.html#MCMixedState.expect_and_grad_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#netket.vqs.MCMixedState.expect_and_grad_operator" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>Ô</strong> (<a class="reference internal" href="../operator/netket.operator.AbstractOperator.html#netket.operator.AbstractOperator" title="netket.operator.AbstractOperator"><em>netket.operator.AbstractOperator</em></a>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="netket.vqs.MCMixedState.grad">
<code class="sig-name descname"><span class="pre">grad</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ô</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#netket.vqs.MCMixedState.grad" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the gradient of the quantum expectation value of a given operator O.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>op</strong> (<a class="reference internal" href="../operator/netket.operator.AbstractOperator.html#netket.operator.AbstractOperator" title="netket.operator.AbstractOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">netket.operator.AbstractOperator</span></code></a>) – the operator O.</p></li>
<li><p><strong>is_hermitian</strong> – optional override for whever to use or not the hermitian logic. By default
it’s automatically detected.</p></li>
<li><p><strong>use_covariance</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>]</em>) – </p></li>
<li><p><strong>mutable</strong> (<em>Optional</em><em>[</em><em>Any</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An estimation of the average gradient of the quantum expectation value &lt;O&gt;.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="netket.vqs.MCMixedState.init">
<code class="sig-name descname"><span class="pre">init</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#netket.vqs.MCMixedState.init" title="Permalink to this definition"></a></dt>
<dd><p>Initialises the variational parameters of the variational state.</p>
</dd></dl>

<dl class="py method">
<dt id="netket.vqs.MCMixedState.init_parameters">
<code class="sig-name descname"><span class="pre">init_parameters</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_fun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#netket.vqs.MCMixedState.init_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Re-initializes all the parameters with the provided initialization function,
defaulting to the normal distribution of standard deviation 0.01.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The init function will not change the dtype of the parameters, which is
determined by the model. DO NOT SPECIFY IT INSIDE THE INIT FUNCTION</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_fun</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://jax.readthedocs.io/en/latest/jax.numpy.html#jaxlib.xla_extension.DeviceArray" title="(in JAX)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeviceArray</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tracer</span></code>]]]) – a jax initializer such as <span class="xref std std-ref">jax.nn.initializers.normal</span>.
Must be a Callable taking 3 inputs, the jax PRNG key, the shape and the
dtype, and outputting an array with the valid dtype and shape. If left
unspecified, defaults to <code class="code docutils literal notranslate"><span class="pre">jax.nn.initializers.normal(stddev=0.01)</span></code></p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – Optional seed to be used. The seed is synced across all MPI processes.
If unspecified, uses a random seed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="netket.vqs.MCMixedState.log_value">
<code class="sig-name descname"><span class="pre">log_value</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">σ</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#netket.vqs.MCMixedState.log_value" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the variational state for a batch of states and returns
the logarithm of the amplitude of the quantum state. For pure states,
this is <span class="math notranslate nohighlight">\(log(&lt;σ|ψ&gt;)\)</span>, whereas for mixed states this is
<span class="math notranslate nohighlight">\(log(&lt;σr|ρ|σc&gt;)\)</span>, where ψ and ρ are respectively a pure state
(wavefunction) and a mixed state (density matrix).
For the density matrix, the left and right-acting states (row and column)
are obtained as <code class="code docutils literal notranslate"><span class="pre">σr=σ[::,0:N]</span></code> and <code class="code docutils literal notranslate"><span class="pre">σc=σ[::,N:]</span></code>.</p>
<p>Given a batch of inputs (Nb, N), returns a batch of outputs (Nb,).</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>σ</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="netket.vqs.MCMixedState.quantum_geometric_tensor">
<code class="sig-name descname"><span class="pre">quantum_geometric_tensor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qgt_T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">QGTAuto()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#netket.vqs.MCMixedState.quantum_geometric_tensor" title="Permalink to this definition"></a></dt>
<dd><p>Computes an estimate of the quantum geometric tensor G_ij.
This function returns a linear operator that can be used to apply G_ij to a given vector
or can be converted to a full matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>qgt_T</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">LinearOperator</span></code>) – the optional type of the quantum geometric tensor. By default it’s automatically selected.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A linear operator representing the quantum geometric tensor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nk.optimizer.LinearOperator</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="netket.vqs.MCMixedState.reset">
<code class="sig-name descname"><span class="pre">reset</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/netket/vqs/mc/mc_mixed_state/state.html#MCMixedState.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#netket.vqs.MCMixedState.reset" title="Permalink to this definition"></a></dt>
<dd><p>Resets the internal cache of th variational state.
Called automatically when the parameters/state is updated.</p>
</dd></dl>

<dl class="py method">
<dt id="netket.vqs.MCMixedState.sample">
<code class="sig-name descname"><span class="pre">sample</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_discard_per_chain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#netket.vqs.MCMixedState.sample" title="Permalink to this definition"></a></dt>
<dd><p>Sample a certain number of configurations.</p>
<p>If one among chain_leength or n_samples is defined, that number of samples
are gen erated. Otherwise the value set internally is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chain_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – The length of the markov chains.</p></li>
<li><p><strong>n_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – The total number of samples across all MPI ranks.</p></li>
<li><p><strong>n_discard_per_chain</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – Number of discarded samples at the beginning of the markov chain.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="netket.vqs.MCMixedState.to_array">
<code class="sig-name descname"><span class="pre">to_array</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#netket.vqs.MCMixedState.to_array" title="Permalink to this definition"></a></dt>
<dd><p>Returns the dense-vector representation of this state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>normalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If True, the vector is normalized to have L2-norm 1.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An exponentially large vector representing the state in the computational
basis.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="netket.vqs.MCMixedState.to_matrix">
<code class="sig-name descname"><span class="pre">to_matrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/netket/vqs/mc/mc_mixed_state/state.html#MCMixedState.to_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#netket.vqs.MCMixedState.to_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Returns the dense-matrix representation of this operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>normalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If True, the matrix is normalized to have trace 1.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An exponentially large matrix representing the state in the computational
basis.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="netket.vqs.MCMixedState.to_qobj">
<code class="sig-name descname"><span class="pre">to_qobj</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#netket.vqs.MCMixedState.to_qobj" title="Permalink to this definition"></a></dt>
<dd><p>Convert this mixed state to a qutip density matrix Qobj.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A <cite>qutip.Qobj</cite> object.</p>
</dd>
</dl>
</dd></dl>

</dd>
</dl>
</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="netket.vqs.MCState.html" class="btn btn-neutral float-left" title="netket.vqs.MCState" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="netket.vqs.get_local_kernel.html" class="btn btn-neutral float-right" title="netket.vqs.get_local_kernel" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2021, The Netket authors - All rights reserved.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 

<script type="text/javascript">
    jQuery(function () {
        SphinxRtdTheme.Navigation.enable(true);
      })
</script>

<!-- Temporary footer
<div class="footer-wip">
  <div class="footer-wip-content">
    This documentation refers to an unreleased version of Netket.
  </div>
</div>
-->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-118013987-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-118013987-1');
</script>

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "url": "https://www.netket.org",
  "name": "NetKet",
  "founder": "Giuseppe Carleo",
  "foundingDate": "2018-04-24",
  "foundingLocation" : "New York",
  "logo": "https://www.netket.org/img/logo_small.jpg",
  "sameAs": [
    "https://twitter.com/NetKetOrg",
    "https://github.com/NetKet/netket"
  ],
  "description" : "Netket is an open-source project delivering cutting-edge
  methods for the study of many-body quantum systems with artificial neural
  networks and machine learning techniques."
}
</script>


</body>
</html>